20/01/25     

                     SUB LANGUAGES TASK
                       -----------------------


1.Create a STUDENT table with the following columns
----->SNO 
----->SNAME
----->GENDER
----->FEE
----->DOB
A: create table STUDENT (SNO number(4),Sname char(10),GENDER char(4),FEE number(8,2),DOB date);


2.What is the command to view the structure of the STUDENT table?
A:describe STUDENT;

3.Insert records into the STUDENT table.
A:INSERT INTO STUDENT VALUES (&SNO,'&SNAME','&GENDER',&FEE,&DOB);

4.Write a query to display all the records from the STUDENT table.
A:SELECT * FROM STUDENT;

5.Write a query to add two columns (address, m1 (marks)) to
  the STUDENT table.
A:ALTER TABLE STUDENT ADD SADDRESS VARCHAR2(50);
  ALTER TABLE STUDENT ADD SMARKS NUMBER(4,2);

6.Write a query to increase the size of the datatype for 
  the SNAME column.
A:ALTER TABLE STUDENT MODIFY SNAME VARCHAR(20);

7.Write a query to drop two columns from the STUDENT table.
A:ALTER TABLE STUDENT DROP COLUMN SADDRESS;
  ALTER TABLE STUDENT DROP COLUMN SMARKS;

8.Write a query to rename the column SNAME to NAME.
A:ALTER TABLE STUDENT RENAME COLUMN SNAME TO NAME;

9.Write a query to drop the STUDENT table.
A:DROP TABLE STUDENT;

10.Write a query to restore the STUDENT table.
A:SHOW RECYCLEBIN FOR OBJECT NUMBER.
  FLASHBACK TABLE STUDENT TO BEFORE DROP;

11.What is the command to permanently delete the data from 
   the table in the database?
A:TRUNCATE TABLE STUDENT;

12.What is the command to rename the table STUDENT to STUDENTDATA?
A:RENAME STUDENT TO STUDENTDATA;

13.Write a query to display the employee names and salaries from 
  the EMP table.
A: SELECT EMPLOYEENAME,SALARY FROM EMP;
OR
SELECT *FROM EMP WHERE EMPLOYEENAME,SALARY;

14.Write a query to display the EMPNO, ENAME, JOB, and HIREDATE 
  from the EMP table.
A:SELECT EMPNO, ENAME, JOB,HIREDATE FROM EMP;

15.Write a query to display all the records from the EMP table.
A:SELECT *FROM EMP;

-----------------------------------------------------------------------------------
1.What is oracle?
    Oracle is a relational database product which is used to
store data perminently in secondary storage devices.

--------------------------------------------------------------------------
2.What is SQL?
  SQL is structured query language.in sql we are writing queries.
with the help of queries we are communicating with the database.

  Sql language was intodused by E.F codd.he is mathametician that's
why he represented data in the format of matrix rows and columns.

-----------------------------------------------------------------------------------
3.What are DDL commands?What is the purpose of create command?

.DDL stands for Data Defination Language
.DDL command are used to define structure of the 
 table.
.The following are the DDL commands.
1)Create                   
2)Alter
3)Drop                     
4)Flashback                
5)Truncate
6)Purge
7)Rename (orace 9i)

1)Create:- it is used to create database objects like 
  =======  tables, views,sequences,indexes,procedures,
            functions...etc 

NOTE:-By default DDL commands are auto commited.
====
-----------------------------------------------------------------------------------
4.What are DML commands
.DML stands for Data Manipulation Language.
.DML commands are used to manipulate data in a table.
.Simply in DML we are dealing on data.
.The following are the DML commands.
1.Insert
2.Update
3.Delete
4.Merge (oracle 9i)
5.insert all


1)Insert: It is used to insert data into a table.
  ======
Method1:-
========
insert into tablename values(value1,value2,.......);

Method2:-(Using Substitutional operator)
========

&------>Enter value for

Same like scanf function '&' is there in C language.i.e is used to read
the values from the keyboard.

Here also it is used to read the values from the keyboard.

insert into tablename values(&col1,&col2.....);

Method3:-(Skipping columns)
========
insert into tablename(col1,col2....)values(value1,value2....);

-----------------------------------------------------------------------------------

21/01/25

                           OPerators Task
                        ===================

2)Relational operators
----------------------
.Relational operators are also called as comparison operators.

.Relational operators are used in where clause only.

.Every relational operator used to compare with 1 value.

.Oracle sql having following relational operators.
 =,<,<=,>,>=,<> or !=


.Where clause is used to filtering the rows or resticting the 
 records purpose we are using.

1.Write a query to display the employee records whose 
  salary is 3000?
A:select*from EMP where SAL=3000;

2.Write a query to display all managers from emp table?

Note:-Oracle is not a case sensitive language.But string comparision 
====      is case sensitive.
A:select*from EMP where JOB='MANAGER';


3.Write a query to display the employees who are getting more
  than 2000 salary from emp table?
A:select*from EMP where SAL>2000;

4.Write a query to display the employees whose sal is 
  3000 or more?
A:select*from EMP where SAL>=3000;

5.Wrirte a query to display the employees who are belongs 
  to 10th department from emp table?
A:select*from EMP where DEPTNO=10;

6.Write a query to display the  employee records whose 
  name is SMITH?
A:select*from EMP where ENAME='SMITH';

7.Write a query to display the employees except job 
  as MANAGER from emp table?

Note: Calender order is Ascending order
====  1-JAN-2024   min date
      2-JAN-2024
      . 
      .
      31-dec-2024  max date 
A:select*from EMP where JOB!='MANAGER';  

8.Write a query to display the employee records who joined 
  on 17th DECEMBER 1980 from emp table?
A:select*from EMP where HIREDATE='17-DEC-80';

9.Write a query to display the employee record who joined
  after 1981 from emp table?
A:select*from EMP where HIREDATE>'31-DEC-1980';

10.Write a query to display the employee record who joined 
   before 1981 from emp table?
A:select*from EMP where HIREDATE<'01-JAN-1982';

11.Write a query to display the employee record who joined after
   november 1981 from emp table?
A:select*from EMP where HIREDATE>'30-NOV-81';

12.Write a query to display the employees who are getting
   more than 30000 annsal from emp table?

Note:Generally in all relational databases we are not allowed to use
     column aliasname in where clause.
A:select*from EMP where SAL*12>30000;

column aliasname:Is used to change column heading in final output.
.to give column aliasname we use "AS" keyword.using "AS" keyword is 
 optional.
.to give column aliasname as multiple words use " ".
.eg "ann sal"

------------------------------------------------------------------------------------------------------
Logical operators
-----------------
.In all relational databases if you want to define more than one 
   condition in where clause
then we must use either AND or by using OR operators.

AND:-AND operator displays the record if both first condition & 
====  second contion are true.

OR:-OR operator is used to displays a record if either first 
===   condition or second condition is true.



eg:-Online shopping(searching for the products)

--->Create a table laptops with sno,cname,price and mfd

     SNO       CNAME              PRICE          MFD
  --------- ----------        ----------      ---------
       1       HP                68000        24-DEC-23
       2      DELL               50000        12-AUG-24
       3     LENOVO              40000        12-JAN-23
       4       HP                44000        08-APR-22

1.Write a query to display laptop detailes whose cname is HP and
  price is more than 50000?
A:SELECT*FROM PRODUCT WHERE CNAME='HP'AND PRICE>50000;


--->Create a student1 table and insert the records as below.

   sno      sname      sub1         sub2        sub3 
  -----    -------    ------       ------      ------  
    1      gowtham      72          18          24
    2       kiran       60          50          45
    3       raju        12          30          25
    4       subbu       80          88          74


2.By using above student table display the passed student records?

---> total marks  :100
---> pass mark is :35
---> pass means student got 35 marks in all 3 subjects.
---> fail means student got below 35 marks in any subject.

A:SELECT*FROM STUDENT WHERE SUB1>34 AND SUB2>34 AND SUB3>34;

3.By using above student table display the failed student records?
A:SELECT*FROM STUDENT WHERE SUB1<34 AND SUB2<34 AND SUB<34;
  

4.Write a query to display the employees whose clerks are getting
   more than 1000 salary from emp table?
A:SELECT *FROM EMP WHERE JOB='CLERK' AND SAL>1000;

5.Write a query to display the employees whose clerks are belongs 
  to 20th department?

Note:- In databases if we want to retrive multiple values within a 
====     single column then we must use OR operator. 
A:SELECT *FROM EMP WHERE JOB='CLERK' AND DEPTNO=20;


6.Write a query to display the all managers and clerks
  from emp table?
A:SELECT *FROM EMP WHERE JOB='CLERK' OR JOB='MANAGER';

7.Write a query to display the employees whose are belongs to 
  20,30,50,70,90 departments from emp table?
A:SELECT *FROM EMP WHERE DEPTNO=20 OR DEPTNO=30 OR DEPTNO=50 OR DEPTNO=70 OR DEPTNO=90;

8.Write a query to display the employee records whose empnos
  are 7902,7788,7900 from emp table?
A:SELECT *FROM EMP WHERE EMPNO=7902 OR EMPNO=7788 OR EMPNO=7900;

9.Write a query to display the emp record whose sal 
   between 2450 and 3000 from emp table?
            |
 range of values are there go with AND
A:SELECT *FROM EMP WHERE SAL>2450 AND SAL<3000;
or 
SELECT*FROM EMP WHERE SAL BETWEEN 2450 AND 3000;

10.Write a query to display the emp records whose joined in
  1981 from emp table?
A:SELECT *FROM EMP WHERE HIREDATE>'31-DEC-80' AND HIREDATE<'01-JAN-82';
OR 
SELECT *FROM EMP WHERE HIREDATE BETWEEN '31-DEC-80' AND '01-JAN-82';


--------------------------------------------------------------------------------------------------------------------------------------------------------------------
22/01/25

                               SPECIAL OPERATORS
                             ====================

1)In operator 
-------------

1.In:- It is used to pick the values one by one
=====        from list of values. 
                  (or) 
it is used to compare column value with list of values.
 

   we can also use in operator in place of OR operator.
when we are retriving multiple values from the same column
in this case In operator performance is very high compared 
to OR operator.
 
.it avoids writing multi equality condition using OR operator.


1.Write a query to display the employees whose are belongs to
  20,30,50,70,90 from emp table by using in operator.
A:select *from emp where deptno in(20,30,50,70,90);

2.Write a query to display the employee records whose names
  are SMITH,JONES,KING from emp table?
A:select *from emp where ENAME in('SMITH','JONES','KING');

3.Write a query to display the employee records whose empnos
  are 7902,7788,7900 from emp table?
A:select *from emp where EMPNO in(7902,7788,7900);

4.Write a query to display the employee records whose sal 
  is 1250,3000,5000 from emp table?
A:select *from emp where SAL in(1250,3000,5000);

5.Write a query to display the employee records except 
  MANAGERS and CLERKS from emp table?
A:select *from emp where JOB NOT in('MANAGERS','CLERKS');

6.Write a query to display the employees who are belongs to other
  than 10,20 from emp table?
A:select *from emp where DEPTNO NOT in(10,20);

7.SQL>select * from emp
      where deptno not in(10,20,null);

o/p:no rows selected
A:


why not in operator does not work with null?
============================================
.not in operator internally uses iogical AND.

Note:- Whenever we are using IN operator then internally database 
====   servers uses logical OR.whenever we are using NOT IN operator
       then database server internally useslogical AND that's why 
       NOT IN does not work with null values. 

-------------------------------------------------------------------------------------
2)Between And operator
------------------------
2)Between:-This operator is used to retrive range of values from a
========== table column.This operator is also call as Between….. And
           operator.

.it is used to compare column values with range of values.

.in oracle Between operator work with number,date data type columns.
 


1.Write a query to display the employees who are getting salary 
         between 2000 to 5000 from emp table 
              by using Between operator? 
A:select * from emp where SAL BETWEEN 2000 AND 5000;


2.Write a query to display the employees who are getting salary 
        not between 2000 - 5000 from emp table
              by using Between operator?
A:select * from emp where SAL NOT BETWEEN 2000 AND 5000;

 
3.Write a query to display the employee records who joined 
  in 1982 from emp table?
A:select * from emp where HIREDATE BETWEEN '01-JAN-82' AND '31-DEC-82';


4.Write a query to display the employee records except joined 
  in 1981 from emp table?
A:select * from emp where HIREDATE NOT BETWEEN '01-JAN-81' AND '31-DEC-81';


5 What is the o/p of the following
  select ename,sal from emp where sal Between 5000 and 2000;
  A.displays between 2000 & 5000 salaries
  B.Error
  C.No rows selected
  D.None
A: C
-------

3)is null and is not null
  -----------------------
   These two operators used in where clause only.These two 
operators are used to test weather a column having null 
values or not.

.for null comparision we must use is null operator.dont use = operator.


1.Write a query to display the employees who are not getting 
  commission from emp table? 
A:select ename,sal from emp where COMM IS NULL;


2.Write a query to display the employees who are getting commission
   from emp table? 
A:select ename,sal from emp where COMM IS NOT NULL;


3.Write a query to display the employee record who are not having 
  the manager ID  from emp table?

A: SQL>SELECT * FROM EMP WHERE MGR IS NULL;

-----------------------------------------------------------------------------------

23/01/25

                          OPERATORS TASK
                        =================
 

4.like operator:-like operator is used to retrive data based on 
===============   specified pattern in where clause.

.like operator performance is very high compare to oracle predefined 
  searching functions.

.In all  relational databases along with like operator oracle provided 2 special
  wild card charcters.These are having special meaning.

1)% -> string or group of characters matching(replaces 0 or 
       any no of characters)
2)_ -> single character matching purpose(replaces 1 char)


1.Write a query to display the employees whose ename start with M 
  from emp table using like operator?
A:select * from emp where ename like'M%';

2.Write a query to display the employees whose ename end with S from 
  emp table using like operator?
A: select * from emp where ename like'%S';

3.Write a query to display the employees whose name contain either
  'AM' or 'AR' strings from emp table by using like operator
A:select * from emp where ename like'%AM%' OR ENAME LIKE '%AR%';


4.Write a query to display the employee records whose name 2nd
 character is A?
A:select * from emp where ename like'_A%';

5.Write a query to display the employee records whose name 3rd 
  character is M?
A:select * from emp where ename like'__M%';

6.Write a query to display the employee records whose name has 4
  letters?
A:select * from emp where ename like'____';

7.Write a query to display the employees who are getting 3 digit
  salary?
A:select * from emp where SAL like'___';

8.Write a query to display the employees who are joining in the year
  81 from emp table using like operator?
A:select * from emp where HIREDATE like'%81';

9.Write a query to display the employees who are joining in the 
  month December from the emp table using like operator.
A:select * from emp where HIREDATE like'%DEC%';

10.Write a query to display the employees who are joining in 
  JAN or DEC month?
A:select * from emp where HIREDATE like'%JAN%'OR HIREDATE LIKE '%DEC%';

11.Write a query to display the employee records whose name started
   and ended with S?
A:select * from emp where ename like'S%S';

12.Write a query to display the employee records whose name 
   starting with VOWEL?
A:select * from emp where ename LIKE'A%' OR ename LIKE'I%'OR ename LIKE'O%' OR ename LIKE'U%';

13.Write a query to display the employees whose ename start 
   with S_ from emp table using
   like operator?

Note:-insert the records with ename as S_ubbu

ANS:-
====
SQL> select * from emp where ename like 'S\_%' escape '\';


-----------------------------------------------------------------------------------------------------
1)Arthematic operators
----------------------
.Airthemetic operators are used in number,date datatype columns.

.Aithmetic operators are used in select clause.Rarely we are
 using in where clause.

1.Write a query to display ename,sal,annsal from emp table?
A:SELECT ENAME,SAL,SAL*12 AS ANNAL_INCOME FROM EMP;

2.Calculate the experience of the all employees from emp table?
A:SELECT ENAME,HIREDATE,(SYSDATE-HIREDATE)/365 AS EXPERIENCE FROM EMP;

calculation of experience of emp means :so many date functions are there
one date function is suitable for calculating exp i.e sysdate

sysdate:it returns current date of the system in oracle date 
=======    format.in oracle by default date formatt
                        is DD-MON-YY


3.Calculate TA,HRA,TAX and NETSAL from emp table based on
  following condintions?
A:SELECT ENAME,SAL,SAL*.1 AS TA,SAL *.2 AS HRA, SAL *.05 AS TAX, SAL+SAL*0.1+SAL*.2
-SAL*.05 AS NETSAL FROM EMP;

10% on sal=>TA
20% on sal=>HRA
5% on sal=>TAx
NETSAL =SAL+TA+HRA-TAX

[TA--->Total Allowance  HRA--->House Rent Allowances   NETSAL--->Take-home Salary]

Gross Salary includes all earnings (before deductions).

Net Salary is the actual salary received after all deductions.

4.Write a query to display the all employee salaries after 
  adding 1200 rupees?
A:SELECT ENAME, SAL,SAL+1200 AS ADDED_SAL FROM EMP;

5.create the student1 table and insert the records as below(this table u already 
                                                             created.)

   sno      sname      sub1         sub2        sub3 
  -----    -------    ------       ------      ------  
    1      gowtham      72          18          24
    2       kiran       60          50          45
    3       raju        12          30          25
    4       subbu       80          88          74

Q)Calculate the total marks of students?
A:SELECT STUDENT1.*,SUB1+SUB2+SUB3 AS TOTAL_MARKS FROM STUDENT1;

Q)Calculate the average marks?
A:SELECT STUDENT1.*,(SUB1+SUB2+SUB3)/4 AS AVERAGE_MARKS FROM STUDENT1;

------------------------------------------------------------------------------------
mixed query
-----------
1.Write a query To display employee who are working as a 
  MANAGER,CLERK and 
  earning salary between 1500 and 3000 and
  joined in 1981 year and 
  not working in deptno 10 or 20?
A:SELECT ENAME FROM EMP WHERE (JOB='MANAGER' OR JOB='CLERK') AND SAL BETWEEN 1500 A
ND 3000 AND HIREDATE LIKE'%81' AND DEPTNO NOT IN(10,20);
-----------------------------------------------------------------------------------
                              NVL & NVL2 FUNCTIONS
                            ======================= 
 
1.Write a query to display ename, sal, comm, sal+comm of the 
    employees from emp table?
A:SELECT ENAME,SAL,COMM,SAL+NVL(COMM,0) FROM EMP;

2.Update the employee commission with in emp table by using nvl2() 
  based on following conditions?
A:SELECT ENAME,SAL,COMM,NVL2(COMM,COMM+500,500) AS UPDATED FROM EMP;

1.if comm-->null then update
     comm-->500

2.if comm-->not null then update
     comm-->comm+500

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
24/01/25

                            DML TASK
                        ===============

NOTE:-Before we are performing all these update and delete operations.
====      better to create one more copy of emp table as follows

create table emp1
as
select * from emp;

Update:-it is used to change data in a table or modify the table data.
=======

syntax:-update tablename set columnname=newvalue
=======        where columnname=oldname;


1.Set sal as 3500 to an employee whose empno is 7934 
  from emp table?
A:UPDATE EMP SET SAL=3500 WHERE EMPNO=7934;

2.Set job as manager&increase 2000 rupees to employees whose
  employee no is 7369 from emp table?
A:UPDATE EMP SET JOB='MANAGER',SAL=SAL+2000 WHERE EMPNO=7369;

3.increase 20% on salary to all managers from emp table?
A:UPDATE EMP SET SAL=SAL+SAL*.2 WHERE JOB='MANAGER';

4.increase 1000 rupees to all employees from emp table?
A:UPDATE EMP SET SAL=SAL+1000;

5.increase 20% on sal,15% on comm to the employees who are getting
 commission from emp table?
A:UPDATE EMP SET SAL=SAL+SAL*.2,COMM=COMM+COMM*.15;

6.Set comm has 700 to the employees who are not getting 
  commission from emp table?
A:UPDATE EMP SET COMM=NVL(COMM,700);

7.Set comm has null whose empno are 7521,7698,7900 from 
  emp table?
A:UPDATE EMP SET COMM=NULL WHERE EMPNO IN(7521,7698,7900);

8.Transfer all 10th department employees into 20th department
  from emp table?

ANS:-
====
SQL>UPDATE EMP SET DEPTNO=20 WHERE DEPTNO=10;


9.increase 10% on sal who joined in 1982 from emp table?
A:UPDATE EMP SET SAL=SAL+SAL*.1 WHERE HIREDATE LIKE'%82';

10.increase 20% on sal who are having more than 41 
   years of experiance from emp table?
A:UPDATE EMP SET SAL=SAL+SAL*.2 WHERE ROUND((SYSDATE-HIREDATE)/365)>41;

11.increase 15% on sal to the employees who are getting more than 
   30000 annual salary from emp table?
A:UPDATE EMP SET SAL=SAL+SAL*0.15 WHERE(SAL*12)>30000;

12.increase 20% on sal whose name is starting with 'A'
   and ending with 'S'?
A:UPDATE EMP SET SAL=SAL+SAL*.2 WHERE ENAME LIKE'A%S';

13.delete an employee record whose empno is 7900 from emp table?
A:DELETE FROM EMP WHERE EMPNO=7900;

14.Write a query to delete the employee records whose 
   experiance is more than 42 years?
A:DELETE FROM EMP WHERE MONTHS_BETWEEN(SYSDATE,HIREDATE)>42;

15.delete all managers records from emp table?
A:DELETE FROM EMP WHERE JOB='MANAGER';

16.delete all 10 and 30 department records from emp table?
A:DELETE FROM EMP WHERE DEPTNO IN(10,30);

17.delete emp table all records.and get back the all records by using
   rollback ?
A:DELETE FROM EMP;
  ROLLBACK;

-----------------------------------------------------------------------------------
 *
***Difference between delete and truncate:-(V.I.M.P)
 * ======================================

===================================================================================
               TRUNCATE           |               DELETE
===================================================================================
1.it is a ddl command             |1.it is a dml command
                                  |
2.structure is remains same       |2.structure is remains same
  data is deleted perminantly.    |  data is deleted temporarly
                                  |  and storing in a buffer.
                                  |
2.if we are using rollback        |3.by using rollback command
  command also we can not get     |  we can get it back the data.
  it back the data.               |      
                                  |
3.it is auto commit command.      |3.it is not auto commit command.
                                  |
4.where clause can not be used    |4.where clause can be used here.
  here.                           |
                                  |
5.we can delete all the records   |5.using it we can delete single or
  only.we can not delete single   |  specific group of records or all 
  or specific group of records.   |  records.
                                  |
6.it is faster                    |6.it is slower
                                  |
7.delete block by block           | 7.delete row by row
                                  |
                                  |
=======================*****========================================================

27/01/25
                           Functions Task
                         =================


1)Write a query to display emp table enames to uppercase?
A:update emp set ename=upper(ename);

2)Write a query to display emp table enames to lowercase?
A:update emp set ename=lower(ename);

3)Modify all emp table enames to initcap case perminently?
A:update emp set ename=initcap(ename);
   
4)create table with fname,lastname insert the records as follows

FNAME      LNAME     
---------- ---------- 
gowtham    raj        
naga       raj        
subba      rao        
kavya      sri

->add a new column NAME by using alter with add
      

SQL>alter table students add name varchar2(10);
SQL>select * from students;

FNAME      LNAME        NAME
---------- -----     ---------
gowtham    raj       
naga       raj        
subba      rao        
kavya      sri        

--->set the output for the NAME column as follows

     NAME
  -----------
  Gowtham Raj
  Naga Raju
  Subba Rao
  Kavya Sri
A:SELECT FNAME||' '||LNAME AS NAMS FROM STUDENTS;

Hint:-our requirement is combine FNAME and LNAME means use 
====   concatination operator.and their starting letter
       of name column  is capital letter for that one use initcap
       store it in a NAME column by using single update command.

5)Write a query to display the emp records whose names
  having 4 characters?
A:SELECT * FROM EMP WHERE ENAME LIKE'____';

6)display the emp records whose names are having more than 5
  charcters?
A: SELECT * FROM  EMP WHERE LENGTH(ENAME)>5;


7)what the o/p of the following
SQL>select length('AB CD') from dual

A)4
B)5
C)6
D)none of the above
 A:B

8)check the following substr() query output



SQL>select substr('ABCDEFGH',2,3) from dual;
A:BCD


SQL> select substr('ABCDEFGH',-2,3) from dual; 
A:GH


SQL>select substr('GOWTHAM RAJ',1,7) from dual;
A:GOWTHAM


SQL)select substr('GOWTHAM RAJ',9) from dual;
A:RAJ

         
SQL)select substr('GOWTHAM RAJ',4,4) from dual;
A:THAM



SQL)select substr('GOWTHAM RAJ',-1) from dual;
A:J



SQL)select substr('GOWTHAM RAJ',-3,4) from dual;
A:RAJ




9)create the table person as below
    pname                 dob           password
  ---------           ----------       ----------
  kiran kumar        30-june-96
 
genarate the password as kira96 by using substr()
A:UPDATE PERSON SET PASSWORD=SUBSTR(PNAME,1,4)||TO_CHAR(DOB,'YY');


10) write a query to display the employees whose ename second 
    letter would be LA from emp table using 
    substring function?
A:SELECT * FROM EMP WHERE SUBSTR(ENAME,2,2)='la';


11)write a query to display employee records whose name started
   with M by using substring function?
A:SELECT * FROM EMP WHERE SUBSTR(ENAME,1,1)='M';


12) write a query to display employee records whose
    names are started with vowel by using 
    substring function?
A:SELECT * FROM EMP WHERE SUBSTR(ENAME,1,1) IN('A','E','I','O','U');


13)write a query to display employee records whose name
   started and end with same letter by using 
   substring function?
A:SELECT * FROM EMP WHERE SUBSTR(ENAME,1,1)= SUBSTR(ENAME,-1,1);


14)write a query to display employee records whose name
   started and end with vowel letter by using
   substring function?
A:SELECT * FROM EMP WHERE SUBSTR(ENAME,1,1) IN ('A','E','I','O','U')AND SUBSTR(ENAME,-1,1) IN ('A','E','I','O','U');
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
28/01/25

                            Functions TASK
                         ---------------------

1.check the outputs of following instr() queries


NOTE:-Always instr() returns position based on last two parameters 
---- but oracle server counts no of characters left side first 
     position onwards



SQL> select instr('ABC*D','*') from dual;
A:4

SQL> select instr('ABCDEFGHCDKMNBCDJ','CD',1,1) from dual;
A:3


SQL> select instr('ABCDEFGHCDKMNBCDJ','CD',-5,2) from dual;
A:3


SQL>select instr('krishna stami lord krishna jai krishna',
                 'krishna',1,2) from dual;
A:20



SQL>select instr('krishna stami lord krishna jai krishna',
                  'krishna',-1,3) from dual;
A:1


SQL>select instr('gowtham raj','raj') from dual;
A:9



SQL>select instr('gowtham raj','sai') from dual;
A:0

-------------------------------------------------------------------------------------------------------------------------------------

2.Find 4th appearence of 'a' in the string 'Maharashtraa'
A:select instr('MAHARASHTRAA','A',1,4) from dual;

-------------------------------------------------------------------------------------------------------------------------------------


3.Set mailids to all the employees by taking ename first 3 characters and
  empno last 3 digits as username for the domain tcs.com 
A:UPDATE EMP SET MAILIDS=SUBSTR(ENAME,1,3)||SUBSTR(EMPNO,-3,3);

-------------------------------------------------------------------------------------------------------------------------------------

4.Check the following lpad() and rpad() queries output

SQL>select lpad('kiran',10,'#') from dual;
A:#####KIRAN


SQL>select lpad('X',4,'X') from dual;
xxxx


SQL> select rpad('ABCD',10,'#')from dual;
A:ABCD######

-------------------------------------------------------------------------------------------------------------------------------------

5.genarate the message if the account no is 1234567473 
  output--->ammount debited from XXXXXX7473
A:SELECT CONCAT('AMMOUNT DEBITED FROM ',REPLACE('1234567473',123456,'XXXXXX')) FROM DUAL;

-------------------------------------------------------------------------------------------------------------------------------------


6.Example
  -------
Create the following TEST table as below
     
           NAME      
     -----------------
       RADHA KRISHNA
       GOWTHAM RAJ
       SUBBA RAO
       NAGA RAJU
       MADAM SIR

---->after inserting the records.add two columns FNAME and LNAME  by
     using alter with add command. 
    
---->And set the output for FNAME,LNAME by using
     substr(),instr() as follows.
         
          FNAME            LNAME
       ---------        ----------
         RADHA            KRISHNA 
        GOWTHAM            RAJ
        SUBBA              RAO
        NAGA               RAJU
        MADAM              SIR     
A: UPDATE TEST SET LNAME=SUBSTR(NAME,INSTR(NAME,' ',-1,1),-1);
   UPDATE TEST SET LNAME=SUBSTR(NAME,INSTR(NAME,' ',-1,1),LENGTH(NAME));

-------------------------------------------------------------------------------------------------------------------------------------

7.Check the following query outputs

 *
***Translate() and Replace():-
 * =========================


SQL> select translate('india','in','xy'),replace('india','in','xy')
     from dual;
A:XYDXA , XYDIA


SQL> select translate('ABCDEF','FEDCBA','123456');
A:654321


SQL> select replace('ABC',' ','india')from dual;
A:ABC



SQL> select replace('SSMISSTHSS','S') from dual;
A:MITH


SQL>select replace('SSMISSTHS','THS') from dual;
A:SSMISS

-------------------------------------------------------------------------------------------------------------------------------------


8. Write a query to count number of times that particular I occurred
    within given string INDIA by using length(),replace()function?
A:SELECT LENGTH('INDIA')-LENGTH(REPLACE('INDIA','I')) FROM DUAL;


NOTE:-If you want to count number of times particular character
      occurs within a given string then also we are using 
      replace function along with length function.

-------------------------------------------------------------------------------------------------------------------------------------
29/01/25

                          DATE FUNCTIONS TASK
                         =====================


1.Write a query to display the employees who are 
     joining in the year '81' from emp table
               using to_char()?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'YY')='81';

2.Write a query to display employeenames and 4 digit year from emp table by
  using to_char()?
A:SELECT ENAME,TO_CHAR(HIREDATE,'YYYY') FROM EMP;


3.Write a query to display the employees who are joining
      in the month December from emp table by
               using to_char()?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'MON')='DEC';

4.Write a query to display the employee records who are joined
  in 1980,1982,1984
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'YYYY')IN('1980','1982','1984');

5.Write a query to display the employees who are joining in
  jan,march,dec months?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'MON') IN('JAN','MAR','DEC');

6.Write a query to display the employees who are joining in 1981
    december?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'MMYY')='1281';

7.Write a query to display the employees who are joining in
   1st and 4th quarter?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'Q') IN('1','4');

8.Write a query to display the employees who are joining in 1981 
   1st quarter?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'YY')='81' AND TO_CHAR(HIREDATE,'Q')='1';

9.Write a query to display employee names,day of join(which day they are join)
A:SELECT ENAME,TO_CHAR(HIREDATE,'DAY') FROM EMP;


10.Write a query to display the employees who are joining 
    on sunday from emp table?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'DY')='SUN';


11.Write a query to display the employees who are joining
     before 15th of every month from emp table 
                using to_char()?
A:SELECT * FROM EMP WHERE TO_CHAR(HIREDATE,'DD')<'15';


12.Write a query to display the employee records who are joined in 
   leap year?

A:SQL> select ename,hiredate
     from emp
     where mod(to_char(hiredate,'yyyy'),4)=0;

ENAME      HIREDATE
---------- ---------
SMITH      17-DEC-80





13.Write a query to convert given date string into client
    requirement format by using to_char() 

Given date is -> '15-JUN-05'
display format is-> '15/JUNE/05'
A:SELECT TO_CHAR(TO_DATE('15-JUN-05'),'FMDD/MONTH/YY') FROM DUAL;


14.write a query which is used to add 5 days to the given date
  '18-apr-08'
A:SELECT TO_DATE('18-APR-08')+5 FROM DUAL;


15.write a query which is used to add 5 days to the given date
  '10-04-08'
A:SELECT TO_DATE('10-04-08','DD-MM-YY')+5 FROM DUAL;

16.Write a query to display the YEAR from '15-aug-2024' ?
A:SELECT TO_CHAR(TO_DATE('15-AUG-2024'),'YEAR') FROM DUAL;


17.Find which day india got independence by using to_char()?
A:SELECT TO_CHAR(TO_DATE('15-AUG-1947'),'DAY') FROM DUAL;

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------30/01/25

                        GROUP FUNCTIONS Task
                     =========================

1.find sum of salaries of all employees from emp table?
A:SELECT SUM(SAL) FROM EMP;

2.find sum of salaries of all managers from emp table?
A:SELECT SUM(SAL) FROM EMP WHERE JOB='MANAGER';

3.find  sum of salaries of  deptno 10,30 from table?
A:SELECT SUM(SAL) FROM EMP WHERE DEPTNO IN('10','30');

4.find average salaries of all employees from emp table?
A:SELECT AVG(SAL) FROM EMP;

5.find average salaries of all clerks from emp table?
A:SELECT AVG(SAL) FROM EMP WHERE JOB='CLERK';

6.find the minimum salary in the table? 
A:SELECT MIN(SAL) FROM EMP;

7.find the maximum salary in emp table?
A:SELECT MAX(SAL) FROM EMP;

8.find the no of employees in emp table?
A:SELECT COUNT(*) FROM EMP;

9.find the no of managers in emp table?
A:SELECT COUNT(*) FROM EMP WHERE JOB='MANAGER';

10.find no of employees in 10,30 departments from emp table?
A:SELECT COUNT(*) FROM EMP WHERE DEPTNO IN('10','30');

12.Write a query to find the no of employees in 4th quarter?
A:SELECT COUNT(*) FROM EMP WHERE TO_CHAR(HIREDATE,'Q')=4;

Count(column name):- It counts number of not null values within
==================      a column. 

13.find how many employees are getting commission?
A:SELECT COUNT(COMM) FROM EMP ;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
                      ORDER BY CLAUSE
                    ==================



1.Display the all employee records and arrange them in desending order
   according to salary
A:SELECT * FROM EMP ORDER BY SAL DESC;


2.display the all employee records and arrange them according to
   seniority
A:SELECT * FROM EMP ORDER BY HIREDATE;


3.display the employee records and display salaries in ascending order
   according to deptno

A: SQL>select ename,deptno,sal from emp order by deptno,sal DESC;


4.check the following order by clause outputs
1)SQL>select ename,comm from emp order by comm desc;

2)SQL>select ename,comm from emp order by comm desc nulls last;


                               Date Functions Task
                            ========================

1.Write a query to display current system date?
A:SELECT TO_DATE(SYSDATE) FROM DUAL;

2.Display the current system date and time?
A:SELECT TO_CHAR(SYSDATE,'DDMONYYYY HH MI SS AM') FROM DUAL;
                              OR
  SELECT TO_DATE(SYSDATE) AND TO_CHAR(SYSDATE,'HH MI SS AM') FROM DUAL;


3.Find the last date from sysdate?
A: SELECT LAST_DAY(SYSDATE) FROM DUAL;


4.Find the last date from given date 16-APR-2024?
A: SELECT LAST_DAY(16-APR-2024) FROM DUAL;

5.Find next month first date?
A:SELECT LAST_DAY(SYSDATE)+1 FROM DUAL;


6.Find current month 1st date?
A:SELECT LAST_DAY(ADD_MONTHS(SYSDATE,-1))+1 FROM DUAL;


7.Find next friday date?
A:SELECT NEXT_DAY(SYSDATE,'FRIDAY') FROM DUAL;


8.Find next month first sunday date?
A:SELECT NEXT_DAY(ADD_MONTHS(SYSDATE,0),'SUNDAY') FROM DUAL;


9.Find the experience of all employees from emp table by using 
   months_between()?
A:SELECT ENAME,MONTHS_BETWEEN(SYSDATE,HIREDATE)/365 FROM EMP;


10.Calulate age( in the form of years and months) of kiran. if dob of
   kiran is 31-DEC-1997?
A:SELECT FLOOR(MONTHS_BETWEEN(SYSDATE,'31-DEC-1997')/12) AS YEARS,
  MOD(FLOOR(MONTHS_BETWEEN(SYSDATE,'31-DEC-1997')),12) AS MONTHS FROM DUAL;

11.display the employee records who are joined today?
A:SELECT * FROM EMP WHERE HIREDATE=SYSDATE;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Q)Write the query to  display the emp_first_name and emp_last_name as emp_fullname and year of birth
  and sort them based on their desending age

emp_id        emp_first_name        emp_last_name     birth date
------      -----------------     --------------      ------------
  1            john                  doe               23-apr-1985
  2            jill                  davis             15-jun-1999
  3            jack                  Johnson           25-oct-1992
  4            james                 Wilson            12-sep-1983

A:SELECT EMP_FIRST_NAME,EMP_LAST_NAME,EMP_FIRST_NAME||' '||EMP_LAST_NAME AS EMP_FULLNAME,TO_CHAR(BIRTH_DATE,'YYYY') AS DOB FROM A
GE ORDER BY DOB DESC ;


--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

31/01/25

1.Write a query to display no of persons in each state 
        from following PERSON table
-->simply i want state wise count

A:SELECT STATE ,COUNT(*) FROM PERSON GROUP BY STATE ORDER BY COUNT(*) DESC;

                                 group by
EG:    Detailed data-------------------------------------->Summarized data


        pid        pname        state                     state      count(*)      
     ---------    -------      --------                  -------    ---------         
         1         SUBBARAO      AP                         AP          4       
         2         KIRAN         TS                         TS          2             
         3         RAJU          TS                         MP          1           
         4         ADITYA        MP                         MH          1              
         5         GOWTHAM       AP                                     
         6         VISWAJITH     MH 
         7         SURYA         AP
         8         SAI TEJA      AP
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

2.Find state wise,gender wise count(population)
  from the following PERSONS table?
A:SELECT STATE,GENDER,COUNT(*) FROM PERSONS GROUP BY STATE,GENDER;

       PID      PNAME         GENDER        STATE
      ------   ---------     --------      --------
         1     SUBBARAO         M             AP
         2      KAVYA           F             TS
         3      KIRAN           M             TS
         4     GOWTHAM          M             AP
         5     KERTHI           F             AP
         6     SURYA            M             AP
         7    ANUSHKA           F             AP
         8      RAJU            M             TS

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
3.Write a query to display number of employees in each department 
   from emp table using group by?
A:SELECT DEPTNO,COUNT(*) FROM EMP GROUP BY DEPTNO ;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
4.Write a query to display number of employees in each job from emp
   table using group by?
A:SELECT JOB,COUNT(*) FROM EMP GROUP BY JOB;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
5.Write a query to display deptno, minimum and maximum salary from 
   emp using group by?
A:SELECT DEPTNO,MIN(SAL),MAX(SAL) FROM EMP GROUP BY DEPTNO;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
6.Write a query to display those departments having more than 3
  employees from emp table?
A:SELECT DEPTNO,COUNT(*) FROM EMP GROUP BY DEPTNO HAVING COUNT(*)>3;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
7. Write a query to display those departments sum(sal) more than 9000
   from emp table by using group by clause?
A:SELECT DEPTNO FROM EMP GROUP BY DEPTNO HAVING SUM(SAL)>9000;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
8.Write a query to display duplicate records from the
  following TEST table ?

SQL>select * from test;

         deptno
      ----------
           10
           10
           10
           20
           20
           20
           30
           30
           40
           50
A: SELECT DEPTNO,COUNT(*) FROM TEST GROUP BY DEPTNO HAVING COUNT(*)>1;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
8.Write a query to display year, no of employees per year 
  in which more than one employee was hired from 
            emp table using group by?
A:SELECT TO_CHAR(HIREDATE,'YYYY'),COUNT(*) AS NO_OF_EMPLOYEES FROM EMP GROUP BY TO_CHAR(HIRED
ATE,'YYYY') HAVING COUNT(*)>1;

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
9.How many employees are joined in january or september month by
  using group by?
A:SELECT TO_CHAR(HIREDATE,'MON'),COUNT(*) FROM EMP GROUP BY TO_CHAR(HIREDATE,'MON')  HAVING TO_CHAR
(HIREDATE,'MON') IN('JAN','SEP');

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
10.Display the sum of salaries of 10th and 30th department by using
  group by?
A:SELECT DEPTNO,SUM(SAL) FROM EMP GROUP BY DEPTNO HAVING DEPTNO IN(10,30);

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
11.Write a query to display no of employees joined in each QUARTER 
   from emp table using group by?
A:SELECT TO_CHAR(HIREDATE,'Q'),COUNT(*) FROM EMP GROUP BY TO_CHAR(HIREDATE,'Q');

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
12.Write a query to display those departments sum(Sal) having more 
  than 3 employees from emp table by using group by clause?

Note:-in all realtional databases we can also use invisible group 
===== functions with in having clause.whenever we are implimenting
      group function reports by using group by clause then 
      database internally having all other group functions.

SQL>select deptno,sum(sal) from emp group by deptno having count(*)>3;
            |---> we can also use invisible group functions in having clause.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
13.Find year wise sales from the following ORDERS table

SQL>select to_char(orderdate,'yyyy'),sum(orderamt) from orders group by to_char(orderdate,'yyyy');


B.Find quarter wise sales from the following ORDERS table

SQL>select to_char(orderdate,'q'),sum(orderamt) from orders group by to_char(orderdate,'q');

orderid     ordername           orderdate            ORDERAMT
-------    ----------         ------------          ---------
  1	    SURYA	       12-DEC-24	       1300
  2	   GOWTHAM	       17-JUN-22	       1800
  3	    RAJU	       16-JAN-22	       800
  4	   GOWTHAM	       23-DEC-23	       1000
  5	   SURYA	       08-MAR-24	       1200
  6	   KIRAN	       02-NOV-23	       600
  7	   RAJU	               04-FEB-24               900

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
03/02/25

                               SET OPERATORS
                           =====================

Set operators are used to retriew data from single or multiple
tables.

Set operators are also called as virtical joins.oracle having following
set operators. These are

1.UNION       ---------->return values unique time + sorting
2.UNION ALL   ---------->unique duplicates
3.INTERSECT   ---------->common values
4.MINUS       ---------->values are in first query and those values are not
                         in second query

1.UNION:-Returns the values unique+sorting
========

eg:-
===
SQL>select job from emp where deptno=10 union select job from emp where deptno=20;

JOB
---------
ANALYST
CLERK
MANAGER
PRESIDENT

2.UNION ALL:-unique duplicates
===========

eg:-
===
SQL>select job from emp where deptno=10 union all select job from emp where deptno=20;

JOB
---------
MANAGER
PRESIDENT
CLERK
CLERK
MANAGER
ANALYST
CLERK
ANALYST

3.INTERSECT:-common values
===========
eg:-
===
SQL>select job from emp where deptno=10 intersect select job from emp where deptno=20;

JOB
---------
CLERK
MANAGER

4.MINUS:-values are in first query and those values are not
=======   in second query


eg:-
===
SQL>select job from emp where deptno=10 minus select job from emp where deptno=20;

JOB
---------
PRESIDENT

----------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                   MCQ'S
                                               ============

1.What is the full form of DDL command
A.Data deleting language            B.Data defination language
C.Data delegating language          D.Dummy data language

ANS:-B

2.Which is not a DML command?
A.DROP              B.DELETE
C.SELECT            D.INSERT

ANS:-   A&C

3.On which commands Rollback is supported?
A.DDL               B.DDL & DML
C.DML               D.none of the above

ANS:-C

4.DELETE command is
A.Deletes all records perminently
B.Delete all records or specified records temporarly
C.Delete all records or specified record perminently
D.Deletes all records temporarly

ANS:-B

5.Which of the following statements contains an error?
A.select * from emp where empid=1003;
B.select empid from emp where empid=1006;
C.select empid from emp;
D.select empid where empid=1009 and lastname='GELLER'; 

ANS:-D

6.The command to eliminate a table from a table from a database
A.REMOVE TABLE CUSTOMERS;
B.DROP TABLE CUSTOMERS;
C.DELETE TABLE CUSTOMERS;
D.UPDATE TABLE CUSTOMERS;

ANS:-B

7.What is the syntax for creating a table?

A.create table [schema]table(column datatype [default.expr][...]);
B.create table into [schema]table(column datatype [default.expr][...]);
C.create table values [schema]table(column datatype[default.expr][...]);
D.none of the above

ANS:A

8.What is the output of the following statement?
  select * from emp where sal between 4000 and 2000
A.it returns who are getting the salaries from 4000 to 2000
B.it returns who are getting the salaries from 2000 to 4000
C.both A and B
D.None of the above

ANS:-D

9.SELECT * FROM EMPLOYEE WHERE SALARY>10000 
  AND DEPT_ID=101;
WHICH OF THE FOLLOWING FEILDS ARE DISPLAYED AS OUTPUT
A.SALARY,DEPT_ID
B.EMPLOYEE
C.SALARY
D.ALL THE FEILDS OF THE EMPLOYEE

ANS:-D

10.in oracle which datatypes are supported to store images,
   audio,vedios?
A.varchar2        B.date
C.LOB,BLOB,CLOB   D.none of the above

ANS:-C

11.Null means
A.Zero
B.-1
C.1
D.Empty

ANS:-D

12.Which of the following are the five built-in functions
  provided by SQL?
A.COUNT,SUM,AVG,MAX,MIN
B.SUM,AVG,MIN,MAX,MULT
C.SUM,AVG,MULT,DIV,MIN
D.SUM,AVG,MIN,MAX,NAME

ANS:-A

13.select ----- from instructor where deptname='Comp.Sci';
Which of the following should be used to find the mean
of the salary?
A.Mean(salary)
B.Avg(salary)
C.Sum(salary)
D.Count(salary)

ANS:-B

14.select ROUND(89.4),TRUNC(89.8) from dual;
which values are displayed
A.89,89              B.90,90
C.90,89              D.89,90

ANS:-A

15.What is the output of the following satement
select Max(100,200) from dual;
A.100           B.100,200
C.200           D.Error

ANS:-D

16.A table T_COUNT has 12 number values as 1,2,3,32,1,1,null,
  24,12,null,32,null
predict the output of the below query

select count(*) from T_count;
A.12                    B.6                 C.9
C.Throws exception because COUNT function doesn't work with null values

ANS:-C

17.select round(45.95),trunc(45.95) from dual;
which values are displayed
A.46 and 45            B.45 and 46
C.46 and 46            D.none


ANS:-A

18.select SUBSTR('NARESH IT,HYDERABAD',1,9) from dual;
A.NARESH                B.IT
C.NARESH IT             D.HYDERABAD

ANS:-C

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

04/02/25

                                    JOINS
                                 ==========



1.Write a query to display the employee names and their 
  department names from emp,dept tables.
A:SELECT ENAME ,DNAME FROM EMP JOIN DEPT ON EMP.DEPTNO=DEPT.DEPTNO;

2.Write a query to display the employees details and department details 
  who are working in the location CHICAGO from emp,dept tables?
A:SELECT ENAME,DNAME FROM EMP JOIN DEPT ON EMP.DEPTNO=DEPT.DEPTNO WHERE LOC='CHICAGO';

Note: If we want to filter the data after joining condition then we 
===== must use and operator in 8i joins.where as in 9i joins we are
      using either AND operator or WHERE clause also.

3.Write a query to display no of employees in each location from 
  emp,dept tables by using equi join?
A:SELECT LOC,COUNT(*) AS NO_OF_EMPLOYEES FROM EMP JOIN DEPT ON EMP.DEPTNO=DEPT.DEPTNO GROUP BY LOC;

4.Write a query to display dname,sum(sal) from emp,dept
   tables by using equi join?
A:SELECT DNAME,SUM(SAL) FROM EMP JOIN DEPT ON EMP.DEPTNO=DEPT.DEPTNO GROUP BY DNAME;


5.Write a query to display blake employee record along with dept details
   from emp,dept tables?
A:SELECT ENAME,HIREDATE,E.DEPTNO,LOC,SAL,DNAME FROM EMP E JOIN DEPT ON E.DEPTNO=DEPT.DEPTNO WHERE ENAME='Blake';


----------------------------------------------------------------------------------------------------------------------------------------------------------------------
6.Check the following non equi join output
SQL>select * from test3;
 
      deptno
     ---------
        10
        20

SQL>select * from test4;
       
       deptno
     ---------
         10
         20
         30

SQL>select * from 
    test3 , test4
    where test3.deptno>test4.deptno;



NOTE:-in oracle when ever one table columns lies between another table
=====  two columns then also we are retriving data from those tables
      by using non equi join.

EG:-
===
SQL>select * from emp;
SQL>select * from salgrade;

SQL>select ename,sal,losal,hisal 
    from emp inner join salgrade
    on sal between losal and hisal;
              (OR)
SQL>select ename,sal,losal,hisal
    from emp inner join salgrade
    on sal>=losal and sal<=hisal;
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
05/02/25

                                JOINS
                             ==========

left outer join:-This join returns all rows from left side table
================  and matching rows from right side table.and also
                  this join returns null values in place of non
                  matching rows in another table.

execution:-
==========
left outer join=====>inner join+left side table remaing
                                records(here left side table
                                         is main table)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
Right outer join:-This join returns all rows from right side table
================  and matching rows from left side table and also
                  returns null values in place of non matching
                  rows in another table.


execution:-
==========
Right outer join=====>inner join+right side table remaing
                                records(here right side table
                                         is main table)

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
SQL> SELECT * FROM EMPLOYEES;

       EMPID     NAME         DEPTNO
     -------  ----------      --------
         1      KIRAN           10
         2     GOWTHAM          20
         3      SURYA
         4      RAJU            20


SQL> SELECT * FROM DEPARTMENTS;

      DEPTNO      DNAME
     -------    ----------
        10         HR
        20         IT
        40      FINANCE

1.Write a query to display employee details along with department details
   also display the employees to whoom deptno is not assign?
A:SELECT * FROM EMPLOYEES E,DEPARTMENTS D ON E.DEPTNO=D.DEPTNO(+);

2.Write a query to display departments and their employees,including departments
  without any employees?
A:SELECT * FROM EMPLOYEES E,DEPARTMENTS D ON E.DEPTNO(+)=D.DEPTNO;

3.Write a query to display all employeenames,all departmentnames
   from emp,dept tables by using full outer join?
A:SELECT * FROM EMPLOYEES E FULL OUTER JOIN DEPARTMENTS D ON E.DEPTNO=D.DEPTNO;
OR
SELECT * FROM EMPLOYEES E,DEPARTMENTS D WHERE E.DEPTNO(+)=D.DEPTNO UNION SELECT * F
ROM EMPLOYEES E,DEPARTMENTS D WHERE E.DEPTNO=D.DEPTNO(+);

4.consider the following two tables perform inner join ,left outer 
  join ,right outer join,full outer join and check the outputs.

SQL>select * from test7;

       SNO
   ----------
        10
        20
        30

SQL>select * from test8;

       SNO
   ----------
        10
        20
        40
A:EQUI JOIN: SELECT *FROM TEST7 T JOIN TEST8 TE ON T.SNO=TE.SNO;
  NON EQUI JOIN: SELECT *FROM TEST7 T JOIN TEST8 TE ON T.SNO>TE.SNO;
  LOJ:SELECT *FROM TEST7 T LEFT OUTER JOIN TEST8 TE ON T.SNO=TE.SNO;
  ROJ:SELECT *FROM TEST7 T RIGHT OUTER JOIN TEST8 TE ON T.SNO=TE.SNO;
  FOJ:SELECT *FROM TEST7 T FULL OUTER JOIN TEST8 TE ON T.SNO=TE.SNO;
  
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

5.Write a query to fetch all employee records from the employee details
  table who have a salary record in the employee salary table.
A:SELECT * FROM EMPLOYEE_DETAILS ED JOIN EMPLOYEE_SALARY ES ON ED.EMPID=ES.ID;

EMPLOYEE DETAILS TABLE:-
======================

empid     name         dob          state
-------  ------      -------       -------
  1      JOHN       23-apr-95       NY
  2      SMITH      15-aug-90       CA
  3      ROHAN      27-apr-96       TX
  4      JOHNSON    12-feb-75       CA
  5      BROWN      05-nov-00       AL
  6      JILL       15-jun-99       CA
  7      JAMES      12-sep-83       WA
  8      JACK       25-sep-82       CA

EMPLOYEE SALARY TABLE:-
======================

  ID          SALARY
------      ----------
   1           15000
   2           20000
   3           25000
   4           18000
   5           35000
   6           40000
   7           45000

----------------------------------------------------------------------------------------------------------------------------------------------------------------------
6.Describe in these two tables what is o/p of inner join,left outer
 join ,right outer join,full outer join

NOTE:- guess with out executing queries what is output in all cases

SQL> select * from test10;

       SNO
   ----------
         1
         1

SQL> select * from test20;

       SNO
   ----------
         1
         1
         1
A:EQUI JOIN: 111111 111111
  NON-EQUI JOIN: NO ROW
  LOJ:111111 111111
  ROJ:111111 111111
  FOJ:111111 111111

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------                                                                                       
                                  JOINS MCQ'S
                               =================

1.The ---- clause must contain a join condition for 
   joining two tables.

A.FROM               B.WHERE
C.BOTH A & B         D.NONE OF THE ABOVE

ANS:-A

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

2.Which type of join includes records from the right table that have no matching 
  key in the left table in the result set?

A. Left outer join
B. Right outer join
C. Full outer join
D. Half outer join

ANS:-B

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

3.which one is the correct syntax for joins?

A.select * from t1,t2 where t1.column1=t2.column2
B.select t1.c1,t2.c2 from table1 t1,table2 t2 where t1.c1=t2.c2
C.select t1.c1,t2.c2 from t1,t2 where c1.t1=c2.t2
D.none of the above

ANS:-B

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

4.The same table appears twice in FROM clause then that type
   of join is called as

A.simple join                 B.non equi join
C.equi join                   D.self join

ANS:- D

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

5.By using which type of join we are getting unmatched rows
   of both the tables in the from clause

A.self join              B.full outer join
C.right outer join       D.left outer join

ANS:-B

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

6.WHICH OF THE FOLLOWING JOIN RETURNS ALL THE RECORDS FROM LEFT TABLE AND
  MATCHING RECORDS FROM RIGHT TABLE

PICK ONE OR MORE OPTIONS

A.LEFT JOIN                   B.LEFT INNER JOIN
C.LEFT RIGHT JOIN             D.LEFT OUTER JOIN

A:D

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
7.CONSIDER FOLLOWING TABLES

                   TABLE S1
     |----------------|--------------------------|
     | COLUMN         |      DESCRIPTION         |
     |--------------- |--------------------------|
     |  ID            |      UNIQUE IDENTIFIER   |
     |----------------|--------------------------|
     | NAME           |       STUDENT NAME       |
     |----------------|--------------------------|
 


                    TABLE S2
     |----------------|--------------------------|
     | COLUMN         |      DESCRIPTION         |
     |--------------- |--------------------------|
     |  ID            |      UNIQUE IDENTIFIER   |
     |----------------|--------------------------|
     | NAME           |       STUDENT NAME       |
     |----------------|--------------------------|
               
      

WHICH OF THE FOLLOWING SQL QUERIES WILL RESULT IN STUDENTS NAMES COMMON TO BOTH
TABLES HAVING THE SAME ID SORTED ALPHABITICALLY?MULTIPLE STUDENTS CAN HAVE SAME 
NAME BUT THEIR IDS WILL BE UNIQUE

A.SELECT S1.NAME FROM S1 INNER JOIN S2 ON S1.ID=S2.ID ORDER BY S1.NAME
B.SELECT NAME FROM S1 OUTER JOIN S2 ON S1.SID=S2.ID ORDER BY ID
C.SELECT S1.SNAME FROM S1 LEFT JOIN S2 ON S1.ID=S2.ID ORDER BY NAME
D.SELECT NAME FROM S2 LEFT JOIN ON S1.ID=S2.ID

ANS:-A
------------------------------------------------------------------------------------------------------------------------
07-02-25
                          SELF JOIN
                        =============


Self join:-joining a table to itself is called self join.here 
=========  joining joining conditional columns must belongs to
           same data type.

Method1:-compare one table one column any value with all other values
========  in same table.

Method2:-compare two different column values in a same table(these
========  columns belong to same data type).


Whenever we are using self joins then we must create table aliasnames in from clause.these aliasnames must be different names.These aliasnames internally 
behave like exact tables when query execution time.

-----------------------------------------------------------------------------------
1. Write a query to display the employees who are getting same salary
    as SCOTT salary from emp table using self join?

NOTE:-when we are comparing one column any value with all
====   other values in same column by using self join then
       we must display data from second alias table only.
SOL:
SQL> SELECT E1.ENAME,E1.SAL FROM EMP E1 JOIN EMP E2 ON E1.SAL=E2.SAL WHERE E2.ENAME='SCOTT';

ENAME             SAL
---------- ----------
SCOTT            3000
FORD             3000
-------------------------------------------------------------------------------------------------------------------

2.Write a query to display the employee names and their manager names
  from emp table by using self join
SOL:
SQL> SELECT E1.ENAME AS EMPLOYEES,E2.ENAME AS MANAGERS FROM EMP E1,EMP E2 WHERE E1.MGR=E2.EMPNO;

EMPLOYEES  MANAGERS
---------- ----------
SCOTT      JONES
FORD       JONES
ALLEN      BLAKE
WARD       BLAKE
MARTIN     BLAKE
TURNER     BLAKE
JAMES      BLAKE
MILLER     CLARK
ADAMS      SCOTT
JONES      KING
BLAKE      KING
CLARK      KING
SMITH      FORD
----------------------------------------------------------------------------------------------------------------------

3.Write a query to display the employee records who are reporting
   to BLAKE as a manager by using self join?
SOL:
SQL> SELECT E1.ENAME AS EMPLOYEE,E2.ENAME AS MANAGER FROM EMP E1,EMP E2 WHERE E1.MGR=E2.EMPNO AND E2.ENAME='BLAKE';

EMPLOYEE   MANAGER
---------- ----------
ALLEN      BLAKE
WARD       BLAKE
MARTIN     BLAKE
TURNER     BLAKE
JAMES      BLAKE
------------------------------------------------------------------------------------------------------------------------


4.Write a query to display the employees who are getting more salary 
   than their manager salary from emp table using self join?
SOL:
SQL> SELECT E1.ENAME AS EMPLOYEE,E1.SAL AS SALARY,E2.ENAME AS MANAGER,E2.SAL AS MANAGER_SALARY FROM EMP E1,EMP
E2 WHERE E1.MGR=E2.EMPNO AND E1.SAL>E2.SAL;

EMPLOYEE       SALARY MANAGER    MANAGER_SALARY
---------- ---------- ---------- --------------
SCOTT            3000 JONES                2975
FORD             3000 JONES                2975
------------------------------------------------------------------------------------------------------------------------

5.Write a query to display BLAKE'S manager name from emp table by
  using self join?
SOL:
SQL> SELECT E1.ENAME AS EMPLOYEE,E2.ENAME AS MANAGER FROM EMP E1,EMP E2 WHERE E1.MGR=E2.EMPNO AND E1.ENAME='BLA
KE';

EMPLOYEE   MANAGER
---------- ----------
BLAKE      KING
------------------------------------------------------------------------------------------------------------------------

6.Write a query to display the employees who are joining
         before their managers from emp table
                by using self join?
SOL:
SQL> SELECT E1.ENAME AS EMPLOYEE,E1.HIREDATE AS EMP_JOIN,E2.ENAME AS MANAGER,E2.HIREDATE AS MG_JOIN FROM EMP E1
,EMP E2 WHERE E1.MGR=E2.EMPNO AND E1.HIREDATE<E2.HIREDATE;

EMPLOYEE   EMP_JOIN  MANAGER    MG_JOIN
---------- --------- ---------- ---------
ALLEN      20-FEB-81 BLAKE      01-MAY-81
WARD       22-FEB-81 BLAKE      01-MAY-81
JONES      02-APR-81 KING       17-NOV-81
BLAKE      01-MAY-81 KING       17-NOV-81
CLARK      09-JUN-81 KING       17-NOV-81
SMITH      17-DEC-80 FORD       03-DEC-81
------------------------------------------------------------------------------------------------------------------------

7.Write a query to display those doctors which are working
  in same hospital with different specality from the below
  table?

note:-Here h1 or h2 any table we can use in select why because of
=====  condition is not there direct comparing.

SQL>select * from hospital;

         ID      NAME    HOSPITALNAME     SPECALITY
      ------ ----------  -------------    ----------
         1     SMITH        APPOLO        PHYSICIAN
         2     ALLEN        APPOLO        HOMEOPATHY
         3     WARD         KIMS          PHYSICIAN
         4     JONES        PRIME         PHYSICIAN 
SOL:
SQL> SELECT H2.NAME AS DOC,H2.HOSPITAL_NAME AS H_NAME FROM HOSPITAL H1,HOSPITAL H2
  2  WHERE H1.HOSPITAL_NAME=H2.HOSPITAL_NAME
  3  AND H1.SPECALITY!=H2.SPECALITY;

DOC   H_NAME
----- ------
SMITH APPOLO
ALLEN APPOLO

-----------------------------------------------------------------------------------

8.WRITE A QUERY TO FETCH STUDENT_NAME AND COURSE_NAME,ORDER BY STUDENT ID.DISPLAY ONLY FIRST 20 RECORDS FROM THE FOLLOWING TABLES?(HCL INTERVIEW QUESTION LATEST)

            STUDENT TABLE
   |-------------------------|--------------------------------|
   |  STUDENT_ID     |    STUDENT_NAME   |
   |--------------------------|--------------------------------|


           		 FEE TABLE
   |-------------------------|----------------------------|
   |    STUDENT_ID   |     COURSE_FEE    |
   |-------------------------|-----------------------------|


              		COURSE TABLE
   |--------------------------|--------------------------------|
   |    COURSE_FEE   |     COURSE_NAME   |
   |---------------------------|-------------------------------|

SOL:
SELECT s.STUDENT_NAME, c.COURSE_NAME
FROM STUDENT s
JOIN FEE f ON s.STUDENT_ID = f.STUDENT_ID
JOIN COURSE c ON f.COURSE_FEE = c.COURSE_FEE
ORDER BY s.STUDENT_ID
LIMIT 20;

=========================================================================================================================================================================
10-02-25
------------  
                     ORDER BY & OFFSET AND FETCH
                    =================================

Order by:-order by clause is used to sorting data either assending 
========  order or desending order.
     
order by clause having two keywords.
1)asc
2)desc
syntax:-
=======
    select * from tablename
    order by columnname[asc/desc];

1.Display the all employee records and arrange them in desending order
   according to salary
sol:
SQL> SELECT * FROM EMP ORDER BY SAL DESC;
----------------------------------------------------------------------------------

2.display the all employee records and arrange them according to
   seniority
sol:
SQL> SELECT * FROM EMP ORDER BY HIREDATE;
-------------------------------------------------------------------------------------------

3.display the employee records and display salaries in ascending order
   according to deptno

SQL>select ename,deptno,sal
    from emp
    order by deptno,sal desc;


4.check the following order by clause outputs
1)SQL>select ename,comm 
         from emp
         order by comm desc;
Output:
ENAME            COMM
---------- ----------
SMITH
CLARK
FORD
JAMES
ADAMS
JONES
BLAKE
MILLER
SCOTT
KING
MARTIN           1400
WARD              500
ALLEN             300
TURNER              0
========================
2)SQL>select ename,comm
     from emp
     order by comm desc nulls last;
Output:
ENAME            COMM
---------- ----------
MARTIN           1400
WARD              500
ALLEN             300
TURNER              0
SCOTT
KING
ADAMS
JAMES
FORD
MILLER
BLAKE
JONES
SMITH
CLARK
------------------------------------------------------------------------------------
Offset:-
========
• introduced in ORACLE 12C.
• it is used to specify no of rows to be skipped.

syntax:-
=======
OFFSET <number> ROW/ROWS

FETCH:-
======
• introduced in ORACLE 12C.
• it is used to specify no of rows to be fetched.
• it is used to display top n rows

syntax:-
=======
FETCH <FIRST/NEXT> <number> ROW/ROWS ONLY


1.Display first 5 rows only from emp table?
Sol:
SQL> SELECT * FROM EMP
  2  FETCH FIRST 5 ROWS ONLY;
===================================
2.Display all emp records except first 5 rows?
Sol:
SQL> SELECT * FROM EMP
  2  OFFSET 5 ROWS
  3  ;
=======================================
3.Display 6th row to 10th row?
Sol:
SQL> SELECT * FROM EMP
  2  OFFSET 5 ROWS
  3  FETCH FIRST 5 ROWS ONLY;
==============================================
4.Display top 3 salaried emp records?
Sol:
SQL> SELECT DISTINCT SAL
  2  FROM EMP
  3  ORDER BY SAL DESC
  4  FETCH FIRST 3 ROWS ONLY;
=================================================
5.Display the most seniour employee record by using
  fetch first clause?
NOTE:-By default calender order is asending order
Sol:
SQL> SELECT * FROM EMP
  2  ORDER BY HIREDATE
  3  FETCH FIRST 1 ROW ONLY;
===============================================
6.Write a query to display 2nd maximum salary by using
   offset and fetch clauses?
Sol:
SQL> SELECT ENAME,SAL
  2  FROM EMP
  3  ORDER BY SAL DESC
  4  OFFSET 1 ROW
  5  FETCH FIRST 1 ROW ONLY;
================================================
7.display job column from emp table by using distinct
   clause?
  Sol:
SQL> SELECT DISTINCT JOB FROM EMP;
================================================================
==========================================================================================================================================================================
11-02-25
------------
                                 SUB QUERYS 
                              ===============

    Query within another query is called as Subquery or Nested query.
Subquerys are used to retrive data from single or multiple tables by using
more than one step process. 

All relational databases having two types of sub querys.
These are

   1. Non- Correlated sub querys
   2. Correlated sub querys

  In Non-correlated sub querys child query is executed first then
only parent query is executed, whereas in correlated sub querys 
parent query is executed first then only child query is executed.

1. Non-Correlated sub querys:-
==============================
Non Corelated subquerys having two parts.
1)Child query
2)Parent query

1. Child Query:- A query which provides values to the another query
==============   is called Child Query or Inner Query.

2. Parent Query:- A query which receiving values from another query 
=================    is called Parent Query or Outer Query.

.In non-correlated sub query maximum limit is up to 255 querys.

NON-CORRELATED SUB QUERY:-
=========================
        |
        |----------->1)single row sub querys
        |----------->2)multiple row sub querys
        |----------->3)multiple column sub querys
        |----------->4)inline views (or)subquery are used in from
                       clause.

1)single row sub querys
=======================
   This is a single row sub query because here child query
returns single value. In single row sub query's we are
using =,<,>,<=,>=, between operators.

RULES:-
=======
1)90%    --------->same column
2)5%     --------->group function
3)3%     --------->expressions
4)2%     --------->different column


select * from emp where condition=(select ............)
      
EG:-
===
SQL> select max(sal) from emp where sal<(select max(sal) from emp);

        Display mechanism in              Task in right hand
         left hand side                        side  

----------------------------------------------------------------------------------------------------------------------------------------------------

1.Write a query to display senior most employee details
   from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE HIREDATE=(SELECT MIN(HIREDATE) FROM EMP);
==============================================================================
2.Write a query to display the employees who are working in
   SMITH department number from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE DEPTNO=(SELECT DEPTNO FROM EMP WHERE ENAME='SMITH');
===============================================================================================
3.Write a query to display the employees who are getting
      more sal than the highest paid employee in 20th
           department from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=20);
================================================================
4.Write a query to display the employees who are getting
      more sal than the lowest paid employee in 10th
           department from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT MIN(SAL) FROM EMP WHERE DEPTNO=10);
==================================================================
5.Write a query to display second maximum salary or second
        highest salary from emp table?
Sol:
SQL> SELECT MAX(SAL) FROM EMP WHERE SAL
  2  <
  3  (SELECT MAX(SAL) FROM EMP);
=============================================
6.Write a query to display second highest sal employee 
            details from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE SAL=
  2  (SELECT MAX(SAL) FROM EMP WHERE SAL<
  3  (SELECT MAX(SAL) FROM EMP));
================================================================
7.Write a query to display the employees who are getting 
       more salary than the avg(sal)from emp?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT AVG(SAL) FROM EMP);
=====================================================================
8.Write a query to display the employee records who are 
        earning more salary than the BLAKE salary?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT SAL FROM EMP WHERE ENAME='BLAKE');
===============================================
9.Write a query to display the employee records whose job 
            title is same as ALLEN?
Sol:
SQL> SELECT * FROM EMP WHERE JOB=
  2  (SELECT JOB FROM EMP WHERE ENAME='ALLEN');
===================================================================
10.find the employee name who is earning max salary from emp table?
Sol:
SQL> SELECT ENAME FROM EMP WHERE SAL
  2  =
  3  (SELECT MAX(SAL) FROM EMP);
==================================================================
11.Write a query to display the employees who are working in sales 
   department from emp,dept tables.
Sol:
SQL> SELECT E.ENAME,D.DNAME FROM EMP E JOIN DEPT D
  2  ON E.DEPTNO=D.DEPTNO WHERE D.DEPTNO=
  3  (SELECT DEPTNO FROM DEPT WHERE DNAME='SALES');
==================================================================
12,13,14,15 try this querys.if we are not getting means tomorrow I will explain.
------------------------------------------------------------------------------------------------------------------------
12.Display the employee records who are senior to blake?
Sol:
SQL> SELECT E1.ENAME,E1.SAL,E1.HIREDATE FROM EMP E1 JOIN EMP E2
  2  ON E1.HIREDATE<E2.HIREDATE WHERE E2.HIREDATE=
  3  (SELECT HIREDATE FROM EMP WHERE ENAME='BLAKE');
==================================================================
13.Write a query to display the employees who are getting more
  salary than the Allen salary and job same as Jones job?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT SAL FROM EMP WHERE ENAME='ALLEN')
  3  AND
  4  JOB=(SELECT JOB FROM EMP WHERE ENAME='JONES');
==================================================================
14.Write a query to display the employees who are working
     under Blake as a Manager from emp table by using
                 empno,mgr columns?
Sol:
SQL> SELECT * FROM EMP WHERE MGR=(SELECT EMPNO FROM EMP WHERE ENAME='BLAKE');
====================================================================================
15.Write a query to display longest ename from emp table?
Sol:
SQL> SELECT ENAME FROM EMP WHERE LENGTH(ENAME)=(SELECT MAX(LENGTH(ENAME)) FROM EMP);
============================================================================================
==========================================================================================================================================================================
12-02-25
------------
2)MULTIPLE ROW SUB QUERYS:-
=========================

Write a query to display employee details who are getting 
maximum sal in each department from emp table.

SQL>select * from emp
    where sal=(select max(sal) from emp group by deptno);
                       2850
                       3000
                       5000

error:single row subquery returns more than one row.
  
   When child query returns multiple values then those querys are
called Multiple row Sub Querys.in multiple row subquery we are
using in,all,any operators.

   Whenever we are using sub query special operator ALL database server
internally uses logical operator AND whereas when we are using subquery 
special operator ANY then database server internally uses logical 
operator OR.

  all---->it satisfies all values in the list
  any---->it satisfies any value in the list


------------------------------------------------------------------------------------
1.Write a query to display employee details who are getting 
      maximum sal in each department from emp table.
Sol:
SQL> SELECT * FROM EMP
  2  WHERE SAL IN
  3  (SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO);
----------------------------------------------------------------------------------------------------------------------

2.Write a query to display the employees who are working in sales
   or research department from emp,dept?
Sol:
SQL> SELECT * FROM EMP E JOIN DEPT D ON E.DEPTNO=D.DEPTNO WHERE E.DEPTNO =ANY
  2  (SELECT DEPTNO FROM DEPT WHERE DNAME IN('SALES','RESEARCH'));
---------------------------------------------------------------------------------------------------------------------------------------------------------

3.Write a query to display the male employees who are getting more
   salary than the all the salaries of female employees?

SQL> select * from employee;

       EMPNO      ENAME       GENDER         SAL
      -------  ----------    --------     --------
         1      Bhargavi        f           4000
         2      subbarao        m           5000
         3      Radhika         f           3000
         4      gowtham         m           2000
         5      kavya           f           2000

Sol:
SQL> SELECT * FROM EMPLOYEE_GENDER WHERE GENDER='m' AND
  2  SAL>(SELECT MAX(SAL) FROM EMPLOYEE_GENDER WHERE GENDER='f');
--------------------------------------------------------------------------------------------------------------------------

4.Write a query to display the employee records whose job title is 
            same as SMITH,BLAKE?
Sol:
SQL> SELECT * FROM EMP WHERE JOB IN
  2  (SELECT JOB FROM EMP WHERE ENAME IN('SMITH','BLAKE'));
-------------------------------------------------------------------------------------------------------------------------
5.Write a query to display the employee records who are earning
  more than all managers?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>ALL
  2  (SELECT SAL FROM EMP WHERE JOB='MANAGER');
NOTE:-if sal> all list of values then condition is true

------------------------------------------------------------------------------------------------------------------------
6.Write a query to display the employee records  who are earning
  more than any of the managers?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>ANY
  2  (SELECT SAL FROM EMP WHERE JOB='MANAGER');
NOTE:-if sal>any one of the list of values.

-----------------------------------------------------------------------------------
==========================================================================================================================================================================================
===========================================================================================================================================================================
13-02-25   
                      INLINE VIEW & ANALYTICAL FUNCTIONS
                      =========================================


1. Inline view:- Oracle 7.2 introduced Inline views.in place of tablename
                 we are writing subquery is called inline view.


Syntax:-
=======
 select * from (subquery);



1.Write a query to display the employees who are getting more
  than 30000 annsal from emp table?


Note:-in where clause we are not allowed to use column aliasname.
=====   then those type of queries we are putting in inline view.
      then internally column aliasname behaves like a exact table
      column 


               -----------------------------
select * from( |  ename  |  sal |  annsal  |)where annsal>30000;
               -----------------------------
               |         |      |          |
               -----------------------------

Sol:
SQL> SELECT * FROM (SELECT ENAME,SAL,SAL*12 AS ANNSAL FROM EMP) WHERE ANNSAL>30000;
-----------------------------------------------------------------------------------

Analytical functions
====================
Oracle having following analytical functions. These are

   1.row_number()

   2.rank()
 *
***3.dense_rank()
 *


syntax:-
=======
Analytical functionname()over
    (partition by columnname
     order by columnname[asc/desc])

   
eg:-
=====
ROW_NUMBER():-
=============

        DEPTNO       ENAME        SAL         R
       --------     --------    -------     -----
          20         SCOTT        2000        1
          20         FORD         2000        2
          20         JONES        3000        3
          20         ALLEN        4000        4
          20         SMITH        5000        5
          20         MILLER       5000        6
          20         MARTIN       5000        7
          20         ADAMS        6000        8



RANK():-
========

       DEPTNO       ENAME        SAL         R
       --------     --------    -------     -----
          20         SCOTT        2000        1
          20         FORD         2000        1
          20         JONES        3000        3
          20         ALLEN        4000        4
          20         SMITH        5000        5
          20         MILLER       5000        5
          20         MARTIN       5000        5
          20         ADAMS        6000        8


DENSE_RANK():-
=============
 
         DEPTNO       ENAME        SAL         R
       --------     --------    -------     -----
          20         SCOTT        2000        1
          20         FORD         2000        1
          20         JONES        3000        2
          20         ALLEN        4000        3
          20         SMITH        5000        4
          20         MILLER       5000        4
          20         MARTIN       5000        4
          20         ADAMS        6000        5


-----------------------------------------------------------------------------------
 *
***Write a query to display 2nd highest salary employee 
 *  from emp table by using analytical function

SQL> SELECT * FROM (SELECT ENAME,SAL,DENSE_RANK()OVER(ORDER BY SAL DESC)R FROM EMP) WHERE R=2;


ENAME             SAL          R
---------- ---------- ----------
SCOTT            3000          2
FORD             3000          2


    
 *
*2*.Write a query to display 3rd highest salary employee in each 
 *   department from emp table by using analytical function
Sol:
SQL> SELECT * FROM(SELECT ENAME,SAL,DEPTNO,DENSE_RANK()OVER(PARTITION BY DEPTNO ORDER BY SAL DESC)R FROM EMP) 
WHERE R=3;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

3.Write a query to display 5th highest salary employee from emp 
  table by using analytical function?
Sol:
SQL> SELECT * FROM(SELECT ENAME,SAL,DENSE_RANK()OVER(ORDER BY SAL DESC)R FROM EMP) WHERE R=5;
-----------------------------------------------------------------------------------------------------------------

4.Write a query to display nth highest salary employee in each department
  from emp table by using analytical function?
Sol:
SQL> SELECT * FROM(SELECT ENAME,SAL,DEPTNO,DENSE_RANK()OVER(PARTITION BY DEPTNO ORDER BY SAL DESC)R FROM EMP) WHERE R=&n;
==============================================================================================================
============================================================================================================================================================================
14-02-25
--------------        
                        ROWID
                              ========

 *
***Delete duplicate rows from a table
 * =================================

 *
*Q*Write a query to delete duplicate rows from following table
 *
SQL>create table test(deptno number(10));
SQL>insert into test values(.......);
SQL>select * from test;
          
          deptno
      ----------
           10
           10
           10
           20
           20
           20
           30
           30
           40
           50
Sol:
SQL> DELETE FROM TEST WHERE ROWID NOT IN (SELECT MIN(ROWID) FROM TEST GROUP BY DEPTNO);
-----------------------------------------------------------------------------------

                               ROWNUM
                             ==========

1.Write a query to display first row from emp table using rownum?
USING SUB-QUERY
------------------------------
SQL> SELECT * FROM(SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R=1;

USING TABLE NAME WITH WHERE:
----------------------------------------------------
SQL> SELECT * FROM EMP WHERE ROWNUM=1;
------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------
NOTE:-Generally, rownum doesn't work with more than 1 +ve integer, 
=====  i.e.,it works with <, <= operators.
-------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------

 *
***Write a query to display last 2 rows from emp table by using
 *     rownum aliasname?
 Sol:
SQL> SELECT * FROM (SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R IN ((SELECT COUNT(*) FROM EMP),(SELECT COUNT(*)
-1 FROM EMP));
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 *
***Note:-in oracle we are creating rownum alliasnames in inline views 
 * ====  then that aliasname work with all sql operators.
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3.Write a query to display second record from emp table using  
   rownum aliasname?
Sol:
SQL> SELECT * FROM(SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R=2;
-----------------------------------------------------------------------------------------------------------------------------
4.Write a query to display rows between 4 to 8 from emp
  table by using rownum aliasname?
Sol:
SQL> SELECT * FROM (SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R BETWEEN 4 AND 8;
-------------------------------------------------------------------------------------------------------------------------------------------------------
5.Write a query to display 2,3,5,6,9th records from emp
  table by using rownum aliasname?
Sol:
SQL> SELECT * FROM (SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R IN(2,3,5,6,9);
----------------------------------------------------------------------------------------------------------------------------------------------
6.Write a query to display even no of records from emp 
  table by using rownum aliasname?
Sol:
SQL> SELECT * FROM (SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE MOD(R,2)=0;
------------------------------------------------------------------------------------------------------------------------------------------
7.Write a quey to display first row,last row from emp table by
  using rownum aliasname?
Sol:
SQL> SELECT * FROM(SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R IN((SELECT MAX(ROWNUM) FROM EMP),(SELECT MIN(ROW
NUM) FROM EMP));
										(or)
SQL> SELECT * FROM (SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R IN(1,(SELECT COUNT(*) FROM EMP));
										(or)
SQL> SELECT * FROM (SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R=1 OR R=(SELECT COUNT(*) FROM EMP);

---------------------------------------------------------------------------------------------------------------------------------------------
8.Write a query to skip 3 rows and then display remaing all rows from
  emp table by using rownum aliasname?
Sol:
SQL> SELECT * FROM (SELECT ROWNUM R,ENAME,SAL FROM EMP) WHERE R>3;
										(or)
SQL> SELECT * FROM(SELECT ROWNUM R,ENAME,SAL FROM EMP) OFFSET 3 ROWS;

============================================================================================================================================================================

17-02-25
--------------
                              JOINS 
                           ==========
1.A new table is created in an oracle database using the  ----- TABLE statement

A.CREATE

B.UPDATE

C.ALTER

D.NEW

ANS:-
A
-----------------------------------------------------------------------------------

2.Which of the following are the types of outer joins?

A. Left Outer Join

B. Right Outer Join

C. Full Outer Join

D. All of the above

ANS:-
D
-----------------------------------------------------------------------------------

3. Most common type of join is ------

A. Inner

B. Outer

C. Anti

D. Equi

ANS:-
A
-----------------------------------------------------------------------------------

4. Which of the following is not the type of join ?

A. Cross Join

B. Anti Join

C. Semi Join

D. None

ANS:-
D
-----------------------------------------------------------------------------------


5. What is another name for cross join ?

A. Left Join

B. Right Join

C. Full join

D. Cartesian Products

ANS:-
D
-----------------------------------------------------------------------------------


6. How many types of joins

A. 5

B. 6

C. 7

D. 8

ANS:-
D
----------------------------------------------------------------------------------

7. How many types of Outer joins are there

A. 1

B. 3

C. 2

D. 4

ANS:- 
B
-----------------------------------------------------------------------------------


8. An Equi join refers to equality by using comparison operator
   in the -----clause

A. FROM

B. HAVING

C. WHERE

D. NONE

ANS:-
C
-----------------------------------------------------------------------------------


9.Oracle joins ------ data from multiple tables into one

A. Retrieve

B. Combine

C. Both A and B

D. None of the above

ANS:-
A
-----------------------------------------------------------------------------------

10. What is the another name for Inner Join ? 

A. Simple Join

B. Natural Join

C. Both A and B

D. None of the above

ANS:- 
A
-----------------------------------------------------------------------------------



11. Each row in a table is simply combined with every other row in the table
    when a ----- join  is

A. Equi 

B. Inner

C. Self

D. Outer

ANS:-
C
-----------------------------------------------------------------------------------


12.The ------ clause must contain a join condition for joining two tables

A. From

B. Where

C. Both A and B

D. None of the above
A
-----------------------------------------------------------------------------------

13.The program compares two columns from different tables and combines pairs
   of rows containing the same row from both tables. Provided that 
   the ------ condition holds.

A. Join

B. Minus

C. Non-Join

D. Addition

ANS:- 
A
-----------------------------------------------------------------------------------

14. ------ Outer Join returns all rows from the left (first) table that are
    specified by the ON condition. and all rows from table that are met
    by the join condition

A. Left

B. Right

C. Middle

D. None

ANS:-
A
----------------------------------------------------------------------------------


15. Which of the following is/are the type(s) of joins ?

A. Inner

B. Outer

C. Equi

D. All of the above

ANS:-
D
----------------------------------------------------------------------------------


16.Tables are joined with themselves (------ relationship) in self joins

A. Unary

B. Binary

C. Ternary

D. None

ANS:-
A
-----------------------------------------------------------------------------------


17.Outer joins return all rows from ------ tables

A. First

B. Second

C. Both

D. None

ANS:-
C
-----------------------------------------------------------------------------------


18. All ------ from multiple tables matching the join condition are returned
    by the inner join

A. Rows

B. Columns

C. Fields

D. None


ANS:-
A
-----------------------------------------------------------------------------------

19. When you join two or more tables, views, or materialized views , you
    combine ------ from both tables ,views or materialized views

A. Rows

B. Columns

C. Both A and B

D. None of the above

ANS:-
A
-----------------------------------------------------------------------------------


20. ------ joins return the values of matching columns across associated
    tables

A. Outer

B. Inner

C. Equi

D. None

ANS:-
C
----------------------------------------------------------------------------------
==================================================================================================================
19-02-25
------------
                           CONSTRAINTS
                         ---------------

-----------------------------------------------------------------------------------
1.Create a student table with constraints based on following
  conditions.

---->after creating the table insert the records and observe
     the outputs.

SID     Don't accept nulls and duplicates

SNAME   Don't accept nulls

M1      Marks between 0 to 100

SQL> CREATE TABLE STUDENT2
(SID NUMBER(4) PRIMARY KEY,SNAME VARCHAR2(10) NOT NULL,M1 NUMBER(3) 
CHECK(M1 BETWEEN 0 AND 100));
Testing:
----------
SQL> INSERT INTO STUDENT2 VALUES(1001,'SMITH',101);-------->Not allowed
SQL> INSERT INTO STUDENT2 VALUES(1001,NULL,100);----------->Not allowed
SQL> INSERT INTO STUDENT2 VALUES(1002,'ALLEN',90);---------->Allowed
-----------------------------------------------------------------------------------
2.Create a employee table with constraints based on following
  conditions.

---->after creating the table insert the records and observe
     the outputs.

USERID     don't accept nulls and duplicates

USERNAME   don't accept nulls and duplicates

PWD         Password minimum 8 characters

SQL> CREATE TABLE EMPLOYEE1
(USERID NUMBER(4),USERNAME VARCHAR2(10),
PWD VARCHAR2(20) CHECK(LENGTH(PWD)>=8),
PRIMARY KEY(USERID,USERNAME));

Testing:
-----------
SQL> INSERT INTO EMPLOYEE1(1005,NULL,'123123@ABC');------------->Not aloowed
SQL> INSERT INTO EMPLOYEE1(1005,'SMITH,'123123@ABC');----------->Allowed
-----------------------------------------------------------------------------------
3.Create the emp3 table with constraints based on following
  conditions.

--->after creating the table insert the records and observe
    the outputs.

EMPNO      don't accept nulls and duplicates 

ENAME      don't accept nulls

GENDER     Must be M or F

SAL        Minimum 5000 (means 5000 or above it will accept)

SQL> CREATE TABLE EMP3(
  2  EMPNO NUMBER(4) PRIMARY KEY,
  3  ENAME VARCHAR2(10) NOT NULL,
  4  GENDER CHAR(1) CHECK(GENDER IN('M','F')),
  5  SAL NUMBER(8,2) CHECK(SAL>=5000))
  6  ;

Testing:
----------
SQL> INSERT INTO EMP3 VALUES(1003,'SONY','F',25000);------------>Allowed
INSERT INTO EMP3 VALUES(1003,NULL,'F',25000)------------------>Not allowed

----------------------------------------------------------------------------------
    

4.Create the BANK table with constraints based on following
  conditions.

--->after creating the table insert the records and observe
    the outputs.

ACCNO       Should not be duplicate & null

ACCTYPE     Must be 'S' OR 'C'

BAL         Must be min 1000

SQL> CREATE TABLE BANK(
  2  ACCNO NUMBER(10) PRIMARY KEY,
  3  ACCTYPE CHAR(1) CHECK(ACCTYPE IN('S','C')),
  4  BAL NUMBER(6) CHECK(BAL>1000)
  5  );

Testing:
-----------
SQL> INSERT INTO BANK VALUES(1010002548,'S',1200);---------->Allowed
SQL> INSERT INTO BANK VALUES(NULL,'S',1200);------------>Not allowed
SQL> INSERT INTO BANK VALUES(1010002548,NULL,1200);----------->Not aloowed
-----------------------------------------------------------------------------------
5.Create table PROJECT table with constraints based on following
  conditions.

--->after creating the table insert the records and observe
    the outputs.

Projec_tid      should not accept nulls & duplicates

Project_name     don't accept nulls

Price            minimum 20000

SQL> CREATE TABLE PROJECT(
  2  PROJECT_ID NUMBER(3) PRIMARY KEY,
  3  PROJECT_NAME VARCHAR2(10) NOT NULL,
  4  PRICE NUMBER(8,2) CHECK(PRICE>=20000)
  5  );

Testing:
-----------
SQL> INSERT INTO PROJECT VALUES(101,'TESLA',15000);------------->Not allowed
SQL> INSERT INTO PROJECT VALUES(NULL,'TESLA',20000);---------->Not allowed
SQL> INSERT INTO PROJECT VALUES(101,NULL,20000);---------------->Not allowed
SQL> INSERT INTO PROJECT VALUES(101,'TESLA',25000);---------->Allowed
-----------------------------------------------------------------------------------
6.Create the vehicle table with constraints based on following
  conditions.

--->after creating the table insert the records and observe
    the outputs.


vehicle_id         don't accept nulls and duplicates 

owner_name         don't accept null values

license_plate      should not be duplicate

 vehicle_type       vehicle type should be either bike or car              


SQL> CREATE TABLE VEHICLE(
  2  VEHICLE_ID NUMBER(4) PRIMARY KEY,
  3  OWNER_NAME VARCHAR2(10) NOT NULL,
  4  LICENSE_PLATE VARCHAR2(10) UNIQUE,
  5  VEHICLE_TYPE VARCHAR2(5) CHECK(VEHICLE_TYPE IN('BIKE','CAR'))
  6  );

Testing:
-----------
SQL> INSERT INTO VEHICLE VALUES(3205,'NARESH',
  2  'AP30123254','BIKE');--------------------------------------------------------------->Allowed
SQL> INSERT INTO VEHICLE VALUES(3205,'NARESH','AP30123254','BIKE');---->Not allowed
SQL> INSERT INTO VEHICLE VALUES(NULL,'NARESH','AP30123254','BIKE');---->NOt allowed
SQL> INSERT INTO VEHICLE VALUES(3205,NULL,'AP30123254','BIKE');=----------------->Not allowed
SQL> INSERT INTO VEHICLE VALUES(3205,'NARESH','AP30123254','SCOOTY');---------->Not allowed

-----------------------------------------------------------------------------------
===================================================================================================================================
21-02-25
------------
                                  CONSTRAINTS
                               =================

1.What is constraint ? What are different types of constraints? Read each
  constraint definition ? 

2.What are the differences b/w primary key and foreign key ?

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
1.Establish the relation b/w course and student table by using
  Primary key, Foreign key

--->after creating the table insert the records and observe
    the outputs.

COURSE                         STUDENT
=======                        ========
PK                            PK                FK
CID    CNAME                  SID     SNAME     CID

QUERY:
------------
SQL> CREATE TABLE COURSE1(CID NUMBER(4) PRIMARY KEY,CNAME VARCHAR2(10));

Table created.

SQL> CREATE TABLE STUDENT3(SID NUMBER(3) PRIMARY KEY,SNAME VARCHAR2(10),CID NUMBER(4) REFERENCES COURSE1(CID));

Table created.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
2.Establish the relation b/w DOCTORS and PATIENTS table by using
  Primary key, Foreign key


DOCTORS                                       PATIENTS
=======                                      ==========
    PK                                           PK                  FK
 DOCTORID     NAME    SPECIALTY                PATIENTID    NAME    DOCTORID 

 QUERY:
-------------
SQL> CREATE TABLE DOCTORS(DOCTORID NUMBER(4) PRIMARY KEY,NAME VARCHAR2(10),SPECIALITY VARCHAR2(10));

Table created.

SQL> CREATE TABLE PATIENTS(PATIENTID NUMBER(3) PRIMARY KEY,NAME VARCHAR2(10),DOCTORID NUMBER(4) REFERENCES DOCT
ORS(DOCTORID));

Table created.
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

3.Create mas table,child table and establish relation b/w tables.

--->after creating the tables insert the records.delete the mas table
    records and observe the outputs in child table.

mas
---
sno ---->primary key 

child
----
sno ---->foreign key along with on delete cascade 
                         
QUERY:
------------
SQL> CREATE TABLE MAS(SNO NUMBER(2) PRIMARY KEY);

Table created.

SQL> CREATE TABLE CHILD(SNO NUMBER(2) REFERENCES MAS(SNO) ON DELETE CASCADE);

Table created.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------
Default -in all relational databases if we want to provide
=======  default values into a table column then we are using
         default clause.

.it is used to apply default value to table column.
.if we pass the value, it takes that value. if we don't pass the value
 it takes default value.


syntax:-
======
columnname datatype(size) default default value

SQL>create table test4(name varchar2(10), sal number(10) default 3000);

SQL>insert into test4(name)values('GOWTHAM');

SQL>insert into test4 values('KIRAN',5000);

SQL>select * from test4;
   
    NAME        SAL
  -------    ---------
  GOWTHAM      3000
  KIRAN        5000



4.Create a student10 table with 4 columns and apply following constraints.

--->after creating the table insert the records and observe
    the outputs.

SID           PK
SNAME         NOTNULL
INAME         default ---->NARESHIT
CITY          default ---->AMMERPET 
fee           default ---->30000

QUERY:
-----------

SQL> CREATE TABLE STUDENT10(SID NUMBER(4) PRIMARY KEY,SNAME VARCHAR2(10) NOT NULL,INAME VARCHAR2(10) DEFAULT 'N
ARESHIT',CITY VARCHAR2(10) DEFAULT 'AMMERPET',FEE NUMBER(6) DEFAULT 30000);

Table created.

SQL> INSERT INTO STUDENT10 VALUES(1001,'NARESH','SATYAMIT','MADHAPUR',25000);

SQL> INSERT INTO STUDENT10(SID,SNAME) VALUES(1002,'HANUMAN');
=================================================================
5.Create the emp4 table with following columns. and you only 
   think which constraint is suitable at table creation 
   it self and use all constraints(SQL SERVER MOCK INTERVIEW QUESTION)

NOTE:-for this question just create the table with constraints
       is enough.

EMPNO     ENAME     SAL     MGRNO     AGE     ADDRESS    PHONO

QUERY:
------------
SQL> CREATE TABLE EMP4(EMPNO NUMBER(4) PRIMARY KEY,ENAME VARCHAR2(10) NOT NULL,SAL NUMBER(6) CHECK(SAL>0),MGRNO NUMBER(4) REFERENCES EMP4(EMPNO),AGE NUMBER(2) CHECK(AGE>=18 AND AGE<=60),ADDRESS VARCHAR2(10) DEFAULT 'AMMERPET',PHONO NUMBER(10) UNIQUE NOT NULL);

Table created.


----------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                 MCQ'S
                              ===========
1.When table is dropped then the status of constraints 
  on that table is

A. Constraints are in invalid state
B. Constraints also dropped
C. No effect on constraints
D .None
SOL:
-------
B

-------------------------------------------------------------------------------------------------------------------------
2.Primary key means the following combinations

A. NOT NULL,CHECK 

B. UNIQUE,REFEERENTIAL

C. UNIQUE,NOT NULL     
 
D. CHECK,FOREIGN key
SOL:
------
C

--------------------------------------------------------------------------------------------------------------------------
3.What is TRUE about DEFAULT constraint?
A. The value will be first be checked for certain conditions before
  inserting it into the column when a default constraint applies
  to a column in the table.
B.in the event of default constraint being applied to a table's
  columns without a user specifying the value to be inserted when
  that constraint was applied ,the default value that was specified
  when the constraint was applied will be put into that column
C. An index can be created on the table using the default constraint
D. None of the above
SOL:
-------
B
--------------------------------------------------------------------------------------------------------------------------------
4.When constraints are disabled then these are in which state

A. Constraints are dropped

B. Exist in the metadata but not working

C. Constraints are not disabled

D.1 and 3 
SOL:
------
B

--------------------------------------------------------------------------------------------------------------------------
5.is it foreign key accepts duplicate values

A. yes           B.no            C. may be         D. none
SOL:
-------
A
-------------------------------------------------------------------------------------------------------------------------
6.can we drop parent table if any child records are found

A. Yes 
      
B.NO

C.MAY BE 
      
D.NONE
SOL:
-------
A

===========================================================================================================================================================================24-02-25
------------
                               JOINS
                             ---------


JOIN SUBSTRACTION:-in all relational database joins eliminating 
=================   matching rows is also called as join substaction.
                   this join substaction is used in left,right,full
                   outer joins.

3)left outer join substaction
=============================
Syntax:-
=======
select *
from tableA left join tableB
on tableA.key=tableB.key
where tableB.key is null;

ex:-
==

SQL>select * from test7;

       SNO
   ----------
        10
        20
        30


SQL>select * from test8;

       SNO
   ----------
        10
        20
        40

 

left outer join substraction:-substraction means eliminating matching
============================   rows.

SQL>select * from test7  left join test8
    on test7.sno=test8.sno
    where test8.sno is null;

      SNO        SNO
   ---------- ----------
        30



-----------------------------------------------------------------------------------


1.Write a query to display the customers and order details.and find the 
  customers who have place an order
 
CUSTOMERS

CUSTOMERID       CUSTOMERNAME
----------      --------------
    1              GOWTHAM
    2               KIRAN
    3               RAJU

ORDERS

ORDERID       CUSTOMERID        ORDERDATE
--------     ------------      -----------
  101             1             12-JAN-24
  102             2             16-JAN-24     

SQL> SELECT *FROM CUSTOMERS JOIN ORDERS ON CUSTOMERS.CUSTOMERID = ORDERS.CUS
TOMERID;

===================================================================================

2.Write a query to display the customer details and order details 
  including customers without orders

SQL> SELECT *FROM CUSTOMERS C LEFT OUTER JOIN ORDERS R ON C.CUSTOMERID = R.CUSTOMERID;

-----------------------------------------------------------------------------------

3.Write a query to find the patients who have booked an appoinment 
  but haven't visited yet.


PATIENTS

PATIENTID          PATIENTNAME            CONTACTNUMBER
---------        ---------------         ---------------
   1                 ANUSHKA               9876543210
   2                 SURYA                 9876500000
   3                 GOWTHAM               9876511111



APPOINTMENTS

APPOINTMENTID      PATIENTID         APPOINTMENTDATE        STATUS
-------------     -----------       -----------------     -----------
   401                 1               24-DEC-24          CHECKED-IN
   402                 2               28-DEC-24          SHEDULED

SQL> SELECT * FROM PATIENTS P JOIN APPOINTMENTS A ON P.PATIENTID=A.PATIENTID WHERE A.STATUS='SCHEDULED
';
===============================================================================

4.Write a query to display the patient details and appoinment details 
  including patients with out appoinments.

SQL> SELECT * FROM PATIENTS P LEFT OUTER JOIN APPOINTMENTS A ON P.PATIENTID
= A.PATIENTID;

-----------------------------------------------------------------------------------


5.Write a query to display customer details and order details
  and find the orders that haven't been shipped yet


CUSTOMERS2 

CUSTOMERID       CUSTOMERNAME         LOCATION
----------      --------------       ----------
    1              SURYA               NEW YORK
    2              ANUSHKA             CHICAGO
    3              KIRAN               DALLAS


ORDERS2

ORDERID      CUSTOMERID       ORDERDATE         STATUS
-------     ------------     -----------       --------
  501           1             13-APR-24         SHIPPED
  502           2             18-APR-24         PENDING
  503           3             26-APR-24         PENDING


SQL> SELECT * FROM CUSTOMERS2 C JOIN ORDERS2 O ON C.CUSTOMERID = O.CUSTOMERID WHERE O.STATUS='PENDING';
-----------------------------------------------------------------------------------



6.Write a query to display employee details who have not assined 
  any project 

EMPLOYEES1

EMPID      ENAME 
-----    ---------    
  1        SURYA
  2        GOWTHAM
  3        ANUSHKA

PROJECTS

PROJECTID         EMPID
---------       --------
  101              1
  102              2

SQL> SELECT * FROM EMPLOYEES1 E LEFT OUTER JOIN PROJECTS P ON E.EMPID = P.EMPID WHERE PROJECTID IS NULL;
==========================================================================================================================
7.Write a query to display the employee details and project details  
  for employees assined to a project

SQL> SELECT * FROM EMPLOYEES1 E RIGHT OUTER JOIN PROJECTS P ON E.EMPID = P.EMPID;

			(OR)

SQL> SELECT E.* FROM EMPLOYEES1 E LEFT OUTER JOIN PROJECTS P ON E.EMPID = P.EMPID WHERE P.EMPID IS NULL;
-----------------------------------------------------------------------------------


8.Write a query to display the employee details who have not been 
  assined any department

 

SQL> SELECT * FROM EMPLOYEES;

       EMPID     NAME         DEPTNO
     -------  ----------      --------
         1      KIRAN           10
         2     GOWTHAM          20
         3      SURYA
         4      RAJU            20


SQL> SELECT * FROM DEPARTMENTS;

      DEPTNO      DNAME
     -------    ----------
        10         HR
        20         IT
        40      FINANCE
 

SQL>SELECT E.* FROM EMPLOYEES E LEFT OUTER JOIN DEPARTMENTS D ON E.DEPTNO =
 D.DEPTNO WHERE E.DEPTNO IS NULL;
                    
===========================================================================================================================================================================
25-02-25
-----------
No Task Today
=================================================================
26-02-25
------------ 
                                SUB QUERYS 
                              ===============


1.Write a query to display senior most employee details
   from emp table?

Sol:
SQL> SELECT * FROM EMP WHERE HIREDATE=
  2  (SELECT MIN(HIREDATE) FROM EMP);
------------------------------------------------------------------------------------------------------------------------
2.Write a query to display the employees who are working in
   SMITH department number from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE DEPTNO=
  2  (SELECT DEPTNO FROM EMP WHERE ENAME='SMITH');
------------------------------------------------------------------------------------------------------------------------
3.Write a query to display the employees who are getting
      more sal than the highest paid employee in 20th
           department from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT MAX(SAL) FROM EMP WHERE DEPTNO=20);
------------------------------------------------------------------------------------------------------------------------
4.Write a query to display the employees who are getting
      more sal than the lowest paid employee in 10th
           department from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE SAL<
  2  (SELECT MIN(SAL) FROM EMP WHERE DEPTNO=10);
------------------------------------------------------------------------------------------------------------------------
5.Write a query to display second maximum salary or second
        highest salary from emp table?
Sol:
SQL> SELECT MAX(SAL) FROM EMP WHERE SAL<
  2  (SELECT MAX(SAL) FROM EMP);
------------------------------------------------------------------------------------------------------------------------
6.Write a query to display second highest sal employee 
            details from emp table?
Sol:
SQL> SELECT * FROM EMP WHERE SAL=
  2  (
  3  SELECT MAX(SAL) FROM EMP WHERE SAL<
  4  (
  5  SELECT MAX(SAL) FROM EMP));
------------------------------------------------------------------------------------------------------------------------
7.Write a query to display the employees who are getting 
       more salary than the avg(sal)from emp?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (
  3  SELECT AVG(SAL) FROM EMP
  4  );
------------------------------------------------------------------------------------------------------------------------
8.Write a query to display the employee records who are 
        earning more salary than the BLAKE salary?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT SAL FROM EMP WHERE ENAME='BLAKE');
------------------------------------------------------------------------------------------------------------------------
9.Write a query to display the employee records whose job 
            title is same as ALLEN?
Sol:
SQL> SELECT * FROM EMP WHERE JOB=
  2  (SELECT JOB FROM EMP WHERE ENAME='ALLEN');
------------------------------------------------------------------------------------------------------------------------
10.find the employee name who is earning max salary from emp table?
Sol:
SQL> SELECT ENAME FROM EMP WHERE SAL=
  2  (SELECT MAX(SAL) FROM EMP);
------------------------------------------------------------------------------------------------------------------------
11.Write a query to display the employees who are working in sales 
   department from emp, dept tables.
Sol:
SQL> SELECT * FROM EMP WHERE DEPTNO=
  2  (SELECT DEPTNO FROM DEPT WHERE DNAME='SALES');
------------------------------------------------------------------------------------------------------------------------
12.Display the employee records who are senior to blake?
Sol:
SQL> SELECT * FROM EMP WHERE HIREDATE<
  2  (SELECT HIREDATE FROM EMP WHERE ENAME='BLAKE');
------------------------------------------------------------------------------------------------------------------------
13.Write a query to display the employees who are getting more
  salary than the Allen salary and job same as Jones job?
Sol:
SQL> SELECT * FROM EMP WHERE SAL>
  2  (SELECT SAL FROM EMP WHERE ENAME='ALLEN')
  3  AND
  4  JOB=
  5  (SELECT JOB FROM EMP WHERE ENAME='JONES');
------------------------------------------------------------------------------------------------------------------------
14.Write a query to display the employees who are working
     under Blake as a Manager from emp table by using
                 empno,mgr columns?
Sol:
SQL> SELECT * FROM EMP WHERE MGR=
  2  (SELECT EMPNO FROM EMP WHERE ENAME='BLAKE');
------------------------------------------------------------------------------------------------------------------------
15.Write a query to display longest ename from emp table?
Sol:
SQL> SELECT ENAME FROM EMP WHERE LENGTH(ENAME)=
  2  (SELECT MAX(LENGTH(ENAME)) FROM EMP);
------------------------------------------------------------------------------------------------------------------------
                                MCQ'S
                              ========

1. Which of the following is an Oracle database object that is used to 
   store data in a structured manner?

a) Trigger

b) View

c) Table

d) Index

Answer: 
C
-----------------------------------------------------------------------------------


2. Which of the following SQL commands is used to retrieve data 
   from a table in Oracle?

a) INSERT

b) DELETE

c) SELECT

d) UPDATE

Answer: 
C
-----------------------------------------------------------------------------------

3. Which of the following is true about a “primary key” in Oracle?

a) It can have duplicate values.

b) It can be NULL.

c) It uniquely identifies each record in a table.

d) It is optional for a table.


Answer:
C
-----------------------------------------------------------------------------------

4. Which of the following Oracle data types can store variable-length 
   character strings?

a) CHAR

b) VARCHAR2

c) NUMBER

d) DATE

Answer:
B
-----------------------------------------------------------------------------------

5. In Oracle, which of the following is the correct order of execution 
   for the SQL query clauses?

a) SELECT, FROM, WHERE, GROUP BY, HAVING, ORDER BY

b) FROM, WHERE, SELECT, GROUP BY, HAVING, ORDER BY

c) WHERE, GROUP BY, HAVING, SELECT, ORDER BY

d) FROM, SELECT, WHERE, GROUP BY, HAVING, ORDER BY

Answer:
C
-----------------------------------------------------------------------------------

6.  Which type of join will return rows from both tables when there is no match, 
    and will display NULLs for non-matching rows?

a) Inner Join

b) Left Outer Join

c) Right Outer Join

d) Full Outer Join

Answer:
D

-----------------------------------------------------------------------------------

7. Which of the following is used to prevent the deletion of records in Oracle?

a) UNIQUE constraint

b) FOREIGN KEY constraint

c) CHECK constraint

d) ON DELETE CASCADE constraint

Answer: 
B
-----------------------------------------------------------------------------------


8. What is the purpose of the Oracle "ROLLBACK" statement?

a) To save changes made in the transaction

b) To undo changes made in the transaction

c) To commit the current transaction

d) To restart the transaction from the beginning

Answer: 
B
-----------------------------------------------------------------------------------

9. Which of the following is used to perform a case-insensitive comparison of strings in Oracle SQL?

a) LIKE

b) IN

c) UPPER()

d) BINARY()

Answer: 
C
-----------------------------------------------------------------------------------

10. Which of the following is true about the "DELETE" statement in Oracle?

a) It removes all rows in a table and frees the space for reuse.

b) It removes rows but does not free space.

c) It cannot be rolled back.

d) It removes the table definition as well.

Answer: 
B
-----------------------------------------------------------------------------------

11. Which Oracle function can be used to find the length of a string?

a) LENGTH

b) SIZE

c) LEN

d) CHAR_LENGTH

Answer: 
A
-----------------------------------------------------------------------------------

12. What is the maximum size of a VARCHAR2 column in Oracle?

a) 1000 bytes

b) 4000 bytes

c) 32767 bytes

d) 10000 characters

Answer:
B
-----------------------------------------------------------------------------------

13. Which of the following Oracle commands is used to add a new column to an 
    existing table?

a) ALTER TABLE ADD COLUMN

b) MODIFY TABLE ADD COLUMN

c) ALTER TABLE ADD

d) ALTER COLUMN ADD

Answer: 
C
-----------------------------------------------------------------------------------

14. In Oracle, the "TO_DATE" function is used to:

a) Convert a string into a date

b) Convert a date into a string

c) Add a time duration to a date

d) Subtract a date from another date

Answer:
A
-----------------------------------------------------------------------------------

15. Which of the following is NOT an Oracle built-in function?

a) COUNT()

b) MAX()

c) AVERAGE()

d) MIN()

Answer:
C
-----------------------------------------------------------------------------------

16. Which of the following is used to enforce data integrity in Oracle?

a) Index

b) Constraint

c) Trigger

d) Procedure

Answer: 
B
-----------------------------------------------------------------------------------

17. Which of the following is true regarding the "TRUNCATE" statement in Oracle?

a) It removes rows from a table but does not free the space used by the rows.

b) It removes all rows from a table and frees the space.

c) It can be rolled back.

d) It removes the structure of the table along with the data.

Answer: 
B
-----------------------------------------------------------------------------------

18. Which of the following clauses is used to sort the result of a query 
    in Oracle?

a) ORDER BY

b) GROUP BY

c) SORT BY

d) SELECT BY

Answer: 
A
-----------------------------------------------------------------------------------

19. Which Oracle function can be used to return the current date and time?

a) SYSDATE

b) CURRENT_DATE

c) NOW()

d) DATE()

Answer:
A
-----------------------------------------------------------------------------------

20. Which of the following is the default schema for a user in Oracle?

a) SYSTEM

b) SYS

c) USER

d) PUBLIC

Answer:
B
-----------------------------------------------------------------------------------

21. What is the primary difference between INNER JOIN and LEFT OUTER JOIN
    in Oracle SQL?

a) INNER JOIN returns matching rows from both tables, while LEFT OUTER JOIN returns
   all rows from the left table and matching rows from the right table.

b) LEFT OUTER JOIN returns matching rows from both tables, while INNER JOIN returns
   all rows from the left table.

c) Both INNER JOIN and LEFT OUTER JOIN return matching rows from both tables.

d) LEFT OUTER JOIN returns all rows from the right table.

Answer: 
A
-----------------------------------------------------------------------------------
22. Which of the following is used to give  privileges to a user in
    Oracle?

a) GRANT

b) REVOKE

c) TEMPORARY

d) CREATE

Answer:
A
-----------------------------------------------------------------------------------

23. Which of the following Oracle commands is used to remove a table from the
    database?

a) REMOVE TABLE

b) DROP TABLE

c) DELETE TABLE

d) TRUNCATE TABLE

Answer: 
B
-----------------------------------------------------------------------------------

24. In Oracle, which type of join includes rows where no matching rows 
    are found in the other table?

a) Left Outer Join

b) Right Outer Join

c) Full Outer Join

d) Inner Join

Answer:
C
-----------------------------------------------------------------------------------

25. Which of the following SQL functions in Oracle returns the number of rows
   in a table?

a) COUNT()

b) TOTAL()

c) NUM()

d) ROWCOUNT()

Answer:
A
-----------------------------------------------------------------------------------

26. Which of the following SQL statements is used to add a new row to an 
    existing table in Oracle?

a) INSERT INTO

b) ADD INTO

c) PUT INTO

d) UPDATE INTO

Answer:
A
-----------------------------------------------------------------------------------

27. In Oracle, what does the GRANT command do?

a) Revokes access rights

b) Assigns access rights to users

c) Creates new users

d) Creates new tables

Answer: 
B
-----------------------------------------------------------------------------------

28. Which Oracle statement is used to update an existing record in a table?

a) MODIFY

b) CHANGE

c) UPDATE

d) SET

Answer: 
C
-----------------------------------------------------------------------------------

29. Which of the following is the correct Oracle data type for storing a
    floating-point number?

a) NUMBER

b) DECIMAL

c) FLOAT

d) REAL

Answer: 
A
-----------------------------------------------------------------------------------
30. Which of the following is a type of subquery in Oracle?

a) Scalar subquery

b) Correlated subquery

c) Nested subquery

d) All of the above

Answer: 
D
-----------------------------------------------------------------------------------

31. Which of the following clauses is used in Oracle SQL to filter grouped rows?

a) HAVING

b) WHERE

c) GROUP BY

d) ORDER BY

Answer: 
A
-----------------------------------------------------------------------------------


32. Which of the following SQL statements will retrieve the highest salary
    from the employees table in Oracle?

a) SELECT MAX(salary) FROM employees;

b) SELECT TOP 1 salary FROM employees ORDER BY salary DESC;

c) SELECT salary FROM employees WHERE salary = MAX(salary);

d) SELECT FIRST(salary) FROM employees;

Answer:
A
-----------------------------------------------------------------------------------

33. What happens when a COMMIT statement is executed in Oracle?

a) It saves all the changes made during the transaction.

b) It discards all the changes made during the transaction.

c) It pauses the transaction.

d) It logs the transaction for future recovery.

Answer: 
A
-----------------------------------------------------------------------------------

34. Which of the following is a correct example of a GROUP BY clause in Oracle?

a) SELECT department, COUNT() FROM employees GROUP BY department;

b) SELECT COUNT() GROUP BY department FROM employees;

c) SELECT department, COUNT() WHERE department GROUP BY employees;

d) SELECT department FROM employees GROUP BY COUNT();

Answer:
A
-----------------------------------------------------------------------------------

35. Which of the following joins returns all rows from the left table and 
    the matched rows from the right table?

a) Right Outer Join

b) Left Outer Join

c) Inner Join

d) Full Outer Join

Answer: 
B
-----------------------------------------------------------------------------------

36. In an INNER JOIN, if there is no matching row in the other table, 
    what is returned?

a) A NULL value for the unmatched row

b) Only the matched rows are returned

c) An error occurs

d) Both matched and unmatched rows are returned

Answer:
B
-----------------------------------------------------------------------------------

37. Which of the following joins returns rows where there is a match
    in both tables?

a) Full Outer Join

b) Left Outer Join

c) Right Outer Join

d) Inner Join

Answer:
D
-----------------------------------------------------------------------------------

38. Which of the following is true about a LEFT OUTER JOIN in Oracle?

a) It only returns rows that exist in the right table.

b) It returns all rows from the right table and matching rows from the left table.

c) It returns all rows from the left table and matching rows from the right table.

d) It only returns rows with matching values in both tables.

Answer:
C
----------------------------------------------------------------------------------

39. What type of join should be used to combine rows from two tables based on a
    related column, where only the matching rows should be returned?

a) Cross Join

b) Inner Join

c) Left Join

d) Right Join

Answer: 
B
-----------------------------------------------------------------------------------

40. Which of the following is true for a CROSS JOIN?

a) It returns the Cartesian product of two tables.

b) It returns only the matching rows from both tables.

c) It returns all rows from the first table and matching rows from the second.

d) It is the same as a LEFT OUTER JOIN.

Answer:
A
-----------------------------------------------------------------------------------

41. What happens when you perform a CROSS JOIN in SQL?

a) The result is a Cartesian product of the two tables, i.e.,
   each row of the first table is combined with every
   row of the second table.

b) The rows from the first table are returned only if there is a match in the second table.

c) The result includes only the rows that have common values in both tables.

d) The result will only show matching rows from both tables.

Answer: 
A
-----------------------------------------------------------------------------------

42. Which of the following join types is used to get a combination of all rows
    from the right table and the matched rows from the left table, including 
    unmatched rows from the right table?

a) Full Outer Join

b) Left Outer Join

c) Right Outer Join

d) Cross Join

Answer:
C
-----------------------------------------------------------------------------------

43. Which of the following would be a correct syntax for an INNER JOIN in Oracle?

a) SELECT * FROM table1 LEFT JOIN table2 ON table1.id = table2.id;

b) SELECT * FROM table1 RIGHT JOIN table2 ON table1.id = table2.id;

c) SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.id;

d) SELECT * FROM table1 CROSS JOIN table2;

Answer:
C
-----------------------------------------------------------------------------------
=================================================================
27-02-25
------------
                     MULTIPLE ROW SUB QUERYS
                   ==========================

1.Write a query to display employee details who are getting 
      maximum sal in each department from emp table.
Sol:
SQL> SELECT * FROM EMP WHERE SAL IN
  2  (SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO);
------------------------------------------------------------------------------------------------------------------------
2.Write a query to display the employees who are working in sales
   or research department from emp,dept?
Sol:
SQL> SELECT * FROM EMP WHERE DEPTNO IN
  2  (SELECT DEPTNO FROM DEPT WHERE DNAME IN('SALES','RESEARCH'));
------------------------------------------------------------------------------------------------------------------------
3.Write a query to display the male employees who are getting more
   salary than the all the salaries of female employees?

SQL> select * from employee;

       EMPNO      ENAME       GENDER         SAL
      -------  ----------    --------     --------
         1      Bhargavi        f           4000
         2      subbarao        m           5000
         3      Radhika         f           3000
         4      gowtham         m           2000
         5      kavya           f           2000

Sol:
SQL> SELECT * FROM EMPLOYEE WHERE GENDER='m' AND SAL
  2  >ALL
  3  (SELECT SAL FROM EMPLOYEE WHERE GENDER='f');
------------------------------------------------------------------------------------------------------------------------
4.Write a query to display the employee records whose job title is 
            same as SMITH,BLAKE?
Sol:
SQL> SELECT * FROM EMP WHERE JOB IN
  2  (SELECT JOB FROM EMP WHERE ENAME IN('SMITH','BLAKE'));
------------------------------------------------------------------------------------------------------------------------
5.Write a query to display the employee records who are earning
  more than all managers?

NOTE:-if sal> all list of values then condition is true
Sol:
SQL> SELECT * FROM EMP WHERE SAL
  2  >ALL
  3  (SELECT SAL FROM EMP WHERE JOB='MANAGER');
------------------------------------------------------------------------------------------------------------------------
6.Write a query to display the employee records  who are earning
  more than any of the managers?

NOTE:-if sal>any one of the list of values.
Sol:
SQL> SELECT * FROM EMP WHERE SAL
  2  >ANY
  3  (SELECT SAL FROM EMP WHERE JOB='MANAGER');
------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------
=================================================================
04-02-25
------------
                                                                         Analytical functions
                                     ====================

Oracle having following analytical functions. These are

   1.row_number()

   2.rank()
 *
***3.dense_rank()
 *


syntax:-
=======
Analytical functionname()over
    (partition by columnname
     order by columnname[asc/desc])

   
---------------------------------------------------------------------------------------------------------------
 *
***Write a query to display 2nd highest salary employee 
 *  from emp table by using analytical function

SQL> select * from(select ename,sal,dense_rank()over(order by sal desc)r from emp)
      where r=2;


ENAME             SAL          R
---------- ---------- ----------
SCOTT            3000          2
FORD             3000          2


    
 *
*2*.Write a query to display 3rd highest salary employee in each 
 *   department from emp table by using analytical function

SQL> SELECT * FROM (SELECT EMP.*,DENSE_RANK()OVER(PARTITION BY DEPTNO ORDER BY SAL DESC) R FROM EMP) WHERE R = 3;

=================================================================
3.Write a query to display 5th highest salary employee from emp 
  table by using analytical function?

SQL> SELECT * FROM (SELECT EMP.*,DENSE_RANK()OVER(ORDER BY SAL DESC) R FROM EMP) WHERE R = 5;
=================================================================
4.Write a query to display nth highest salary employee in each department
  from emp table by using analytical function?

SQL> SELECT * FROM
  2  (SELECT EMP.*,DENSE_RANK()OVER(PARTITION BY DEPTNO ORDER BY 	SAL DESC) R FROM EMP)
  3  WHERE R=1;
=================================================================
5.execute the queries by using row_num() and rank() and observe the outputs.

SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM,DENSE_RANK()OVER(PARTITION BY DEPTNO 	ORDER BY SAL) R FROM EMP)
  3  WHERE ROWNUM = 1;

---------------------------------------------------------------------------------------------------------------

                                ROWID
                              ========

 *
***Delete duplicate rows from a table
 * =================================

 *
*Q*Write a query to delete duplicate rows from following table
 *
SQL>create table test(deptno number(10));
SQL>insert into test values(.......);
SQL>select * from test;
          
          deptno
      ----------
           10
           10
           10
           20
           20
           20
           30
           30
           40
           50
SQL> DELETE FROM TEST WHERE ROWID NOT IN(SELECT MIN(ROWID) FROM TEST GROUP BY DEPTNO);
---------------------------------------------------------------------------------------------------------------

                               ROWNUM
                             ==========

1.Write a query to display first row from emp table using rownum?

SQL> SELECT * FROM EMP WHERE ROWNUM = 1;
					Or

SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R = 1;

NOTE:-Generally, rownum doesn't work with more than 1 +ve integer, 
=====  i.e.,it works with <, <= operators.

=================================================================
 *
***Write a query to display last 2 rows from emp table by using
 *     rownum aliasname?
 
SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R<=(SELECT COUNT(*) 	FROM EMP)
  3  MINUS
  4  SELECT * FROM
  5  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R<=(SELECT COUNT(*) 	FROM EMP)-2;

									Or
SQL> SELECT * FROM EMP
  2  MINUS
  3  SELECT * FROM EMP WHERE ROWNUM<=(SELECT COUNT(*) FROM EMP)-2;
=================================================================
 *
***Note:-in oracle we are creating rownum alliasnames in inline views 
 * ====  then that aliasname work with all sql operators.

3.Write a query to display second record from emp table using  
   rownum aliasname?
SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R=2;
=================================================================
4.Write a query to display rows between 4 to 8 from emp
  table by using rownum aliasname?
SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R<=8
  3  MINUS
  4  SELECT * FROM
  5  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R<4;
=================================================================
5.Write a query to display 2,3,5,6,9th records from emp
  table by using rownum aliasname?
SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R IN(2,3,5,6,9);
=================================================================
6.Write a query to display even no of records from emp 
  table by using rownum aliasname?
SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE MOD(R,2)=0;
=================================================================
7.Write a quey to display first row,last row from emp table by
  using rownum aliasname?

SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP)
  3  WHERE R=1
  4  OR
  5  R=(SELECT COUNT(*) FROM EMP);
=================================================================
8.Write a query to skip 3 rows and then display remaing all rows from
  emp table by using rownum aliasname?

SQL> SELECT * FROM
  2  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R<=(SELECT COUNT(*) FROM EMP)
  3  MINUS
  4  SELECT * FROM
  5  (SELECT EMP.*,ROWNUM R FROM EMP) WHERE R<=3;

------------------------------------------------------------------------------------------------------------------------
===========================================================================================================================================================================
05-03-05
********
                                 CORELATED SUBQUERYS
                                =====================                   

-----------------------------------------------------------------------------------

 *
*1*Write a query to display 2nd highest salary employee from
 *     emp table by using corelated subquery ?

SQL> SELECT * FROM EMP E1 WHERE 2 = (SELECT COUNT(DISTINCT SAL) FROM EMP E2 WHERE E2.SAL>=E1.SAL );
------------------------------------------------------------------------------------------------------------------------

 *
*2* Write a query to display nth highest salary employee from emp table
 *              by using corelated subquery ?
SQL> SELECT * FROM EMP E1 WHERE &N= (SELECT COUNT(DISTINCT SAL) FROM EMP E2 WHERE E2.SAL>=E1.SAL);
-----------------------------------------------------------------------------------



3.Write a query to display the employees who are getting more sal
  than the average salary of their jobs from the following emp table
              by using corelated subquery ?

     EMPNO        ENAME         SAL          JOB
    -------     ---------     -------      ------- 
       1          smith         5000         sw 
       2          allen         1000        clerk
       3          ward          1000         sw
       4          martin        4000        clerk

SQL> SELECT * FROM EMPLOYEE E1 WHERE SAL>(SELECT AVG(SAL) FROM EMPLOYEE E2 WHERE E2.JOB=E1.JOB);
------------------------------------------------------------------------------------------------------------------------

 
4.Write a query to display those departments from dept table having employees
      in emp table by using corelated subquery exists operator ?

SQL> SELECT * FROM DEPT D WHERE EXISTS (SELECT DEPTNO FROM EMP E WHERE E.DEPTNO=D.DEPTNO);
------------------------------------------------------------------------------------------------------------------------


5.Write a query to display those departments from dept table having employees 
       in emp table by using non corelated subquery in operator ?

SQL> SELECT * FROM DEPT D WHERE DEPTNO IN(SELECT DEPTNO FROM EMP E WHERE E.DEPTNO=D.DEPTNO);
------------------------------------------------------------------------------------------------------------------------

6.Write a query to display the employees who are getting same salary as
    SCOTT salary from emp table by using corelated subquery 
                     exists operator ?
SQL> SELECT * FROM EMP E1 WHERE EXISTS
  2  (SELECT SAL FROM EMP E2 WHERE E2.SAL=E1.SAL AND 	E2.ENAME='SCOTT');
------------------------------------------------------------------------------------------------------------------------

7.Write a query to display those department from dept does not have employees
          in emp table by using corelated subquery ?

SQL> SELECT * FROM DEPT D WHERE DEPTNO NOT EXISTS   (SELECT  * FROM EMP E WHERE E.DEPTNO=D.DEPTNO);
------------------------------------------------------------------------------------------------------------------------

8.Write a query to display those department from dept does not have employees
         in emp table by using  non corelated subquery ?


SQL> SELECT * FROM DEPT WHERE DEPTNO NOT IN(SELECT DEPTNO FROM EMP);
							OR
SQL> SELECT * FROM DEPT WHERE DEPTNO >ALL(SELECT DEPTNO FROM EMP);
							OR
SQL> SELECT * FROM DEPT WHERE DEPTNO !=ALL(SELECT DEPTNO FROM EMP);
------------------------------------------------------------------------------------------------------------------------

 *
*** How to Copying table and copying records
 * =========================================

.copying a table means, creating new table from existing table

.for copying table we use create command

.new table will created with select query result.
 
NOTE:- In al relational databases whenever we are copying a
=====  table from another table all constraints are never
       copied except not null constraint.

Eg:-
===
SQL> create table dept1
     as
     select * from dept;

9.Create new table with name emp6 from existing table emp ?
SQL> CREATE TABLE EMP6 AS SELECT * FROM EMP;
------------------------------------------------------------------------------------------------------------------------
 *
***How to copying table structure
 *
syntax:-
=======
create table newtablename
  as
select stmt
from oldtablename
where false condition;

.eg of false condition
----> 1=2
---->'A'='B'

10.Create a table with the name emp7 from existing table emp without
    rows(copying table structure)
SQL> CREATE TABLE EMP7 AS SELECT * FROM EMP WHERE SAL=0;
-----------------------------------------------------------------------------------

Q.write a query to display 2nd highest salary employee from the 
  following table by using corelated subquery?


SQL>create table test(ename varchar2(10),sal number(10));
SQL>insert into test values(......);
SQL>select * from test;


      ENAME          SAL
    --------      ----------
      abc            100
      xyz            150
      gowtham        200-----------
      pqr            300           |------->counting 200 1 time is SOLUTION
      zzz            200-----------                      |
                                                         |
                                                 distinct clause
                                                         |
                                                         |
                                                 duplicate data is
                                                    eliminating
                                                       



SQL>select * from test e1                          
    where 2=(select count(*) from test e2
    where e2.sal>=e1.sal);

no rows selected

   whenever resource table having duplicate data and also when we are
try to retrive data based on duplicate values by using above quey 
then database server does not return any rows.to overcome this problem
then we must use distinct clause with in count() function.

solution:-
========
SQL>select * from test e1                          
    where 2=(select count(distinct(sal)) from test e2
    where e2.sal>=e1.sal);

     ENAME          SAL
   ---------     ---------
     gowtham       200
     zzz           200
  
EXECUTION PROCESS:-
================== 
Phase1:-
======
step1:-Get a candidate row(first row)------>(abc 100)

step2:-select count(distinct(sal)) from test e2
       where e2.sal>=100;
 
             4

step3:-select * from test e1
       where 2=4;(false)

when condition is false then that candidate row does not return into
result.

Phase2:-
========
step1:-Get a candidate row(xyz,150)
======

step2:-select count(distinct(sal)) from test e2
======  where e2.sal>=150;

             3

step3:-select * from test e1
======  where 2=3;(false)

when condition is false then that candidate row does not return into
result.

Phase3:-
======
step1:-Get a candidate row(gowtham 200)

step2:-select count(distinct(sal)) from test e2
======  where e2.sal>=200;

             2

step3:-select * from test e1
======  where 2=2;(true)

gowtham 200

when condition is true then that record return into result.



Phase4:-
======
step1:-Get a candidate row(first row)------>(pqr 300)

step2:-select count(distinct(sal)) from test e2
       where e2.sal>=300;
 
             1

step3:-select * from test e1
       where 2=1;(false)

when condition is false then that candidate row does not return into
result.

Phase5:-
======
step1:-Get a candidate row(zzz 200)

step2:-select count(distinct(sal)) from test e2
======  where e2.sal>=200;

             2

step3:-select * from test e1
======  where 2=2;(true)

when condition is true then that record return into result.

zzz 200

-----------------------------------------------------------------------------------
=================================================================07-03-25
*******
                                  VIEWS
                                =========

1.What is view? View store data or not? How can you give the guarantee
  view does not store the data?

1)It is a subset/virtual table of base table.
2)It does not store data/Information but store 'SELECT query'.
3)Data is only calculated and presented on demand, not physically stored within the view itself.
============================================================================
2.Create a view from emp table with following columns
  empno,ename,sal,deptno
  After creating the view insert the records
  into view?

SQL> CREATE VIEW V1 AS SELECT EMPNO,ENAME,SAL,DEPTNO FROM EMP;
SQL> INSERT INTO V1 VALUES(1111,'YUVIN',1000,20);
============================================================================

3.After creating the view v1 on empno,ename,sal,deptno.give the access 
  on view v1 to other user?

SQL> CREATE TABLE V2 AS SELECT * FROM V1;

============================================================================
3.Create view from emp table and store only department 10th details?

SQL> CREATE VIEW V3 AS SELECT * FROM EMP WHERE DEPTNO=10;
=================================================================================
4.What is comlex view ? Create a complex view from the following 
  two tables ?Can you perform DML operations through complex view 
  to base table possible or not possible? 

SQL>create table test1(name varchar2(10));
SQL>create table test2(sub varchar2(10));


SQL> CREATE VIEW V4 AS SELECT NAME,SUB FROM TEST1 JOIN TEST2 ON TEST1.NAME=T
EST2.SUB;
				(OR)
SQL> CREATE VIEW V5 AS SELECT NAME,SUB FROM TEST1,TEST2;

NO, you cannot perform DML operations through complex view 
 to base table possible or not possible.
===============================================================================
5.What is Materialized view? MVIEWS stores data or not?What is the 
  Purpose of MVIEWS?

A Materialized View (MV) is a database object that stores the results of a query as a physical object (table), which can be periodically refreshed or updated. It is similar to a regular view, but the main difference is that while a regular view just stores a query definition, a materialized view stores the query results as actual data.
Does MVIEWS store data?

Yes, Materialized Views do store data. When a materialized view is created, the results of the underlying query are stored physically in the database. This data is materialized, meaning it is saved in the database rather than being dynamically computed each time the view is accessed, like a regular view.

Purpose of Materialized Views:

    Performance Improvement:
    Reduced Query Load:
    Data Availability:
    Precomputation:
    Faster Refresh Mechanisms:
    Refreshing Materialized Views:
    Complete refresh: ================================================================================
6.What are the differences b/w View and Materialized VIEW?

 *
***Differnce b/w view & materialized view(V.V.I.M.P)
 * ======================================

          View                              Materialized view
-----------------------------------------------------------------------------------
1.view does not stores any data     |1.M.views stores data
                                    |
2.security purpose                  |2.improves performance(for joins,aggrigate
                                    |  functions)purpose.
                                    |
3.when we are dropping a base table |3.when we are dropping a base table  
  then view can not be accessable.  |  also. M.view can be accessable. 
                                    |
4.we can perform dml operations on  |4.we can not perform dml operations on
  views                             |  M.views

===========================================================================

7.What are the uses of the views?

Views can be used as security mechanisms by letting users access data through the view, without granting users permissions to directly access the underlying tables of the query. Views can be used to provide a backward compatible interface to emulate a table that used to exist but whose schema has changed.
=================================================================


10-03-25
*******
                                SEQUENCE
                              ===========

1.What is Sequence ? What is main purpose of Sequence?
Ans:
------
* Sequence is a database object  which is used to generate sequence numbers on a specific column in the table automatically.

*It will provide a facility on a table is called as "AUTO INCREMENTAL VALUE".

=================================================================
2.Create a sequence ?Sequence stat with 5 and generate values
  upto 10

SQL> CREATE SEQUENCE SQ1
  2  START WITH 5
  3  MINVALUE 1
  4  INCREMENT BY 1
  5  MAXVALUE 10;
=================================================================
3.Genarate the primary key values for the following column sno
  by using sequence.

SQL>create table test(sno number(10) primary key,name varchar2(10));

---->create a sequence first 
---->create the table test table as shown in above
---->insert into test(sno,name)values(s1.nextval,'&name');
---->only we are proving the values to name column.by using
     sequence pseudo column nextval we are generating values 
     automatically to sno column.


---->after inserting the records add Rollno column

SNO      NAME       ROLLNO
---     ------     --------
1        GOWTHAM     
2        SUBBARAO    
3        RAJU        
4        KIRAN  

---->create one more sequence s2 and stating value is 73     

---->by using one update command with sequence pseudo 
     column(nextval)
     genarate the output as follows

SNO      NAME       ROLLNO
---     ------     --------
1        GOWTHAM     73
2        SUBBARAO    74
3        RAJU        75
4        KIRAN       76

Queries:
-----------
SQL> CREATE TABLE TEST(SNO NUMBER(10) PRIMARY KEY,NAME VARCHAR2(10));

SQL> CREATE SEQUENCE S1
  2  START WITH 1
  3  MINVALUE 1
  4  INCREMENT BY 1
  5  MAXVALUE 4;

Inserting rows:
-------------------
SQL> INSERT INTO TEST VALUES(S1.NEXTVAL,'&NAME');
Enter value for name: GOWTHAM

SQL> /
Enter value for name: SUBBARAO

SQL> /
Enter value for name: RAJU

SQL> /
Enter value for name: KIRAN

SQL> ALTER TABLE TEST ADD ROLLNO NUMBER(2);

Table altered.

SQL> CREATE SEQUENCE S2
  2  START WITH 73
  3  MINVALUE 1
  4  INCREMENT BY 1
  5  MAXVALUE 76;

SQL> UPDATE TEST SET ROLLNO=S2.NEXTVAL WHERE SNO=1;

SQL> UPDATE TEST SET ROLLNO=S2.NEXTVAL WHERE SNO=2;

SQL> UPDATE TEST SET ROLLNO=S2.NEXTVAL WHERE SNO=3;

SQL> UPDATE TEST SET ROLLNO=S2.NEXTVAL WHERE SNO=4;

SQL> SELECT * FROM TEST;

=================================================================
4.NOTE:-Oracle 12c onwards we can also use sequence pseudo columns
        with in default clause

syntax:-
=======
columnname number(size) default sequencename.nextval primary key

--->Create a sequence first and sequence start with 1001
--->Create table test1 with ACCNO column by using above syntax
    and NAME,BAL columns
--->Insert the values only NAME,BAL columns by using 
    skipping columns method
--->And observe the output and beauty of sequence

Queries:
-----------

SQL> CREATE SEQUENCE S3
  2  START WITH 1001
  3  MINVALUE 1
  4  INCREMENT BY 1
  5  ;


SQL> CREATE TABLE TEST1(ACCNO NUMBER(4) DEFAULT S3.NEXTVAL PRIMARY KEY,NAME VARCHAR2(10),BAL NUMBER(8,2));

SQL> INSERT INTO TEST1(NAME,BAL)VALUES('NARESH',10000);
SQL> INSERT INTO TEST1(NAME,BAL)VALUES('PRASANTH',30000);
SQL> INSERT INTO TEST1(NAME,BAL)VALUES('SHYAM',21000);
SQL> INSERT INTO TEST1(NAME,BAL)VALUES('LOKESH',32000);

NOTE:-This kind of EXAMPLE is very usefull in Advance Java JDBC
 =================================================================        
5.What is cache?what is default size of cache?
Ans:
------
* When we create a sequence object with "CAHCE" then the set of sequence numbers are saved in database memory and also the copy of data is saved in cache memory.

* The size of the cache file and it will create with 2kb memory.
 =================================================================
===================================================================================
14-03-25(holi)
**************        
                     INDEX
                          ==========
1.What is index ? what are different types of indexes?
Ans:	
		It is a database object which is used to retrieve the required 
row/rows from a table fastly.
=>Types of indexes:
	1.B-Tree Index
	2.Bitmap Index
-----------------------------------------------------------------
2.What is the purpose of indexes?
Ans:	
	Whenever we want to retrieve the required row/rows from a table then we
must use INDEXED KEY COLUMN under where clause condition then only indexes are 
working.
-----------------------------------------------------------------
3.Which query is retrieve data very fastly from database ?
 
A)select * from emp where ename='FORD';

B)select * from emp where empno=7902;

ANS:-B
-----------------------------------------------------------------
4.Which queries are searching for indexes(retrive the data very fastly from following queries)

A.select * from emp;

B.select * from emp where empno=7902;

C.select empno,count(*) from emp
   group by empno;

D.select * from emp order by empno asc;


ANS:-B
-----------------------------------------------------------------

5.create index in1 on emp table ename column
SQL> CREATE INDEX IN1 ON EMP(ENAME);
-----------------------------------------------------------------
6.What is the command to drop in1 index
SQL> DROP INDEX IN1;
-----------------------------------------------------------------
7.How to find out a query is searching for indexes or not in oracle

 in oracle if we want to identify whether a query is internally searching for indexes or not then we are using following command.

syntax:-
=======
set autotrace explain;

 whenever we are using this command then oracle server display query result and also display internal execution plans.

EG:-(with out using indexes)
===========================
SQL>set autotrace on explain;

SQL>select * from emp where ename='FORD';



     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO
---------- ---------- --------- ---------- --------- ---------- ---------- ----------
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20


Execution Plan
----------------------------------------------------------
Plan hash value: 3956160932

--------------------------------------------------------------------------
| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |      |     1 |    38 |     3   (0)| 00:00:01 |
|*  1 |  TABLE ACCESS FULL| EMP  |     1 |    38 |     3   (0)| 00:00:01 |
--------------------------------------------------------------------------
       |                                              |
       |-->this is a full                             |---->CPU cost is very high means performance
           scan                                                  is very low.


EG2:-(with using indexes)
=========================
SQL>create index in1 on emp(ename);
SQL>select * from emp where ename='FORD';


     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO
---------- ---------- --------- ---------- --------- ---------- ---------- ----------
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20


Execution Plan
----------------------------------------------------------
Plan hash value: 2495761290

--------------------------------------------------------------------------------------------
| Id  | Operation                           | Name | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                    |      |     1 |    38 |     2   (0)| 00:00:01 |
|   1 |  TABLE ACCESS BY INDEX ROWID BATCHED| EMP  |     1 |    38 |     2   (0)| 00:00:01 |
|*  2 |   INDEX RANGE SCAN                  | IN1  |     1 |       |     1   (0)| 00:00:01 |
--------------------------------------------------------------------------------------------


SQL>set autotrace off;

-----------------------------------------------------------------------------------

8.What is normalization ?
Ans:
	Normalization is a technique which is used to decompose a table data into 
multiple tables.
-----------------------------------------------------------------------------------
9.What is 1NF?
Ans:
For a table to be in 1NF, It should follow the following 4 rules:
	1.Each column should automic value(Automic = single).
	2.A column should contain values that are same datatype.
	3.All the columns in a table should have unique names.
	4.The order in which data is stored, does not matter.

===================================================================================
17-03-25
********     
                             PL/SQL
                              ============



1.Write a PL/SQL program to print a message 'WELCOME TO PL/SQL  
  CLASSES FOR MY DEAR WONDERFULL BATACH39' on screen?


NOTE:-To avoid of displaying old and new parametes setverify off as
      following

SQL>set verify off;

SQL> BEGIN
  2  DBMS_OUTPUT.PUT_LINE('WELCOME TO PL/SQL CLASSES FOR MY DEAR                         WONDERFULL BATCH42');
  3  END;
  4  /
-----------------------------------------------------------------------------------

2.Write a PL/SQL program to add 2 numbers.and two numbers are 
  enter from runtime ?

DECLARE
A NUMBER(2) := &A;
B NUMBER(2) := &B;
BEGIN
DBMS_OUTPUT.PUT_LINE('SUM OF TWO NUMBERS IS:'||(A+B));
END;
/
Enter value for a: 2
Enter value for b: 4
SUM OF TWO NUMBERS IS:6
-----------------------------------------------------------------------------------

3.Write a PL/SQL program for user entered empno then display name
  of the employee and his salary from emp table?
SOL:
----
DECLARE
E_EMPNO EMP.EMPNO%TYPE := &EMPNO;
E_ENAME EMP.ENAME%TYPE;
E_SAL EMP.SAL%TYPE;
BEGIN
SELECT ENAME,SAL INTO E_ENAME,E_SAL FROM EMP WHERE EMPNO=E_EMPNO;
DBMS_OUTPUT.PUT_LINE(E_ENAME||','||E_SAL);
END;
/
Enter value for empno: 7788
SCOTT,3000
-----------------------------------------------------------------------------------

4.Write a PL/SQL program which is used to retrive maximum salary
      from emp table and store it into PL/SQL variable
              and display maximum salary?
SOL:
----
DECLARE
MAX_SAL EMP.SAL%TYPE;
BEGIN
SELECT MAX(SAL) INTO MAX_SAL FROM EMP;
DBMS_OUTPUT.PUT_LINE('MAXMIMUM SALARY IS:'||MAX_SAL);
END;
/
MAXMIMUM SALARY IS:5000
-----------------------------------------------------------------------------------

5.Write a PL/SQL program to find maximum number from 2 numbers
  and store it into another variable?

note:-in pl/sql expressions we are not allowed to use group 
=====  functions,decode conversion functions.but we are allowed to use number
      functions,character functions,date functions in pl/sql 
      expressions
SOL:
----
DECLARE
A NUMBER(2) := &A;
B NUMBER(2) := &B;
C NUMBER(2);
BEGIN
IF(A>B) THEN
C := A;
DBMS_OUTPUT.PUT_LINE('A IS MAXMIMUM:'||C);
ELSE
C := B;
DBMS_OUTPUT.PUT_LINE('B IS MAXIMUM:'||C);
END IF;
END;
/
Enter value for a: 5
Enter value for b: 8
B IS MAXIMUM:8

-----------------------------------------------------------------------------------

6.Write a PL/SQL program for user entered empno then display 
      all details of employee from emp table by using 
               row level attributes?
SOL:
---
DECLARE
I EMP%ROWTYPE;
E_EMPNO EMP.EMPNO%TYPE := &EMPNO;
BEGIN
SELECT EMPNO,ENAME,SAL,DEPTNO,HIREDATE INTO I.EMPNO,I.ENAME,I.SAL,I.DEPTNO,I.HIREDATE FROM EMP WHERE EMPNO
=E_EMPNO;
DBMS_OUTPUT.PUT_LINE('EMPLOYEE DETAILS: '||I.EMPNO||','||I.ENAME||','||I.SAL||','||I.DEPTNO||','||I.HIREDATE);
END;
/
Enter value for empno: 7788
EMPLOYEE DETAILS: 7788,SCOTT,3000,20,09-DEC-82
-----------------------------------------------------------------------------------

7.Write a PL/SQL program to calculate the experience of the given employee

enter empno:7902
experience is:43years
SOL:
---
DECLARE
E_EMPNO EMP.EMPNO%TYPE := &EMPNO;
E_EXPERIENCE NUMBER(5);
BEGIN
SELECT TRUNC((SYSDATE-HIREDATE)/365) INTO E_EXPERIENCE FROM EMP WHERE EMPNO = E_EMPNO;
DBMS_OUTPUT.PUT_LINE('EXPERIENCE IS: '||E_EXPERIENCE||'years');
END;
/
Enter value for empno: 7902
EXPERIENCE IS: 43years
-----------------------------------------------------------------------------------


=================================================================================
18-03-25
********
                                  PL/SQL
                                =========

1.Write a PL/SQL program eligible for voting system 

if age is>=18 then display a msg :u r eligible for voting
if age is<18 then display a msg  :u not eligible for voting or
                                 better luck next time

DECLARE
AGE NUMBER(2);
BEGIN
AGE := &AGE;
IF(AGE>=18) THEN
DBMS_OUTPUT.PUT_LINE('U R ELIGIBLE FOR VOTING');
ELSE
DBMS_OUTPUT.PUT_LINE('U R NOT ELIGIBLE FOR VOTING');
END IF;
END;
/

-----------------------------------------------------------------------------------


2.Write a PL/SQL program from dept table by using
   conditional statements 

if deptno=10 then display a msg ---->ten
if deptno=20 then display a msg ---->twenty
if deptno=30 then display a msg ---->thirty
if deptno=40 then display a msg ---->others 

DECLARE
V_DEPTNO DEPT.DEPTNO%TYPE := &DEPTNO;
BEGIN
SELECT DEPTNO INTO V_DEPTNO FROM DEPT WHERE DEPTNO =     	  V_DEPTNO;
IF(V_DEPTNO = 10) THEN
DBMS_OUTPUT.PUT_LINE('TEN');
ELSIF(V_DEPTNO = 20) THEN
DBMS_OUTPUT.PUT_LINE('TWENTY');
ELSIF(V_DEPTNO = 30) THEN
DBMS_OUTPUT.PUT_LINE('THIRTY');
ELSE
DBMS_OUTPUT.PUT_LINE('OTHERS');
END IF;
END;
/
Enter value for deptno: 10
TEN
----------------------------------------------------------------------------------

3.Write a PL/SQL program to print 2024 calendar?

01-JAN-24
02-JAN-24
.........
.........
31-DEC-24

DECLARE
start_date DATE := TO_DATE('01-JAN-2025', 'DD-MON-YYYY');
end_date DATE := TO_DATE('31-DEC-2025', 'DD-MON-YYYY');
current_date DATE;
BEGIN
current_date := start_date;
WHILE current_date <= end_date LOOP
DBMS_OUTPUT.PUT_LINE(TO_CHAR(current_date, 'DD-MON-YY'));
current_date := current_date + 1;
END LOOP;
END;
/
-----------------------------------------------------------------------------------

4.Write a PL/SQL program to print 1..10 numbers by using
   for loop

DECLARE
NUM NUMBER;
BEGIN
NUM := 0;
FOR NUM IN 0..12
LOOP
DBMS_OUTPUT.PUT_LINE(NUM);
END LOOP;
END;
/

				(OR)
BEGIN
FOR N IN 0..12
LOOP
DBMS_OUTPUT.PUT_LINE(N);
END LOOP;
END;
/
-----------------------------------------------------------------------------------

5.Write a PL/SQL program to print 10..1 numbers reverse by
   using for loop

DECLARE
NUM NUMBER;
BEGIN
NUM := 10;
FOR N IN 1..10
LOOP
DBMS_OUTPUT.PUT_LINE(NUM);
NUM := NUM-1;
END LOOP;
END;
/
				(OR)
BEGIN
FOR N IN REVERSE 1..10
LOOP
DBMS_OUTPUT.PUT_LINE(N);
END LOOP;
END;
/
-----------------------------------------------------------------------------------
6.Write a PL/SQL program to increase salary of the given empno
  with given amount.after increasing the sal display the salary
  of the employee?

enter empno:7499
enter amount:2000
salary increased(msg i want to display)
sal is:3600
SOL:
----
 DECLARE
 E_EMPNO EMP.EMPNO%TYPE := &EMPNO;
 E_AMOUNT NUMBER := &E_AMOUNT;
 E_SAL EMP.SAL%TYPE;
 BEGIN
 SELECT SAL INTO E_SAL FROM EMP WHERE EMPNO = E_EMPNO;
 E_SAL := E_SAL+E_AMOUNT;
 DBMS_OUTPUT.PUT_LINE('SAL IS:'||E_SAL);
 END;
 /
Enter value for empno: 7499
Enter value for e_amount: 2000
SAL IS:3600

===================================================================================

20-03-25
********     
                    CURSORS
                            ===========

      Cursor is a private sql memory area which is used to process multiple records and also this is an record by record process.


  *         /To process multiple records.
 *** CURSOR
  *         \record by record process.


    Oracle having two types of static cursors.These are
1)Implicit cursor
2)Explicit cursor

2)Explicit cursor:-for sql statements return multiple records is 
=================  called explicit cursor.explicit cursor memory area is also called  as "active set area".in explicit
cursor internally having record by record process.

Explicit cursor life cycle
==========================
       Every explicit cursor having following 4 step process.these
are

1)declare
2)open
3)fetch
4)close

1)declare:-in declare section of the pl/sql block we are declaring
            the cursor by using following syntax.

syntax:-
=======
cursor cursorname is select * from tablename
where condition;

eg:-
===
SQL>declare
    cursor c1 is select * from emp
    where job='CLERK';

2)open:-whenever we are opening the cursor then only oracle server
======  retrive data from table into cursor memory area.because in all
        relational databases whenever we are opening the cursor then
        only cursor select statements are executed.

syntax:-
======
open cursorname;

    in oracle this open statement is used in exeutable section of
the pl/sql block.

NOTE:-Every cursor memory area internally having a pointer whenever
====   we are opening the cursor.this cursor pointer always points
      to first record in cursor memory area.

3)fetch:-(fetching data from cursor memory area)
================================================
  By using fetch statement we are fetching data from cursor memory
area into pl/sql variables

syntax:-
=======
fetch cursorname into variablename1,variablename2;

4)close:-whenever we are closing the cursor then automatically all
========  the resources allocated from cursor memory area is 
          automatically released.

syntax:-
=======
close cursorname;


-----------------------------------------------------------------------------------


1.Write a pl/sql explicit cursor program which is used
   to display all employee names and their salaries
     from emp table by using %notfound attribute?

1)%notfound:-This attribute always returns boolean value either
             true or false.this attribute returns true whenever 
             fetch stmt does not fetches any row from cursor memory
             area.
where as it returns false when fetch stmt fetches atleast one row 
from cursor memory are.

syntax:-
=======
cursorname%notfound;

Sol:
----
DECLARE CURSOR C1 IS SELECT ENAME,SAL FROM EMP;
V_ENAME EMP.ENAME%TYPE;
V_SAL EMP.SAL%TYPE;
BEGIN
OPEN C1;
LOOP
FETCH C1 INTO V_ENAME,V_SAL;
DBMS_OUTPUT.PUT_LINE(V_ENAME||','||V_SAL);
EXIT WHEN C1%NOTFOUND;
END LOOP;
CLOSE C1;
END;
/

-----------------------------------------------------------------------------------

2.Write a pl/sql cursor program which is used to display total salary from emp table without using sum() function ?

sol:
---
DECLARE CURSOR C1 IS SELECT SAL FROM EMP;
V_SAL EMP.SAL%TYPE;
NUM NUMBER := 0;
BEGIN
OPEN C1;
LOOP
FETCH C1 INTO V_SAL;
EXIT WHEN C1%NOTFOUND;
NUM := NUM+V_SAL;
END LOOP;
CLOSE C1;
DBMS_OUTPUT.PUT_LINE('TOTAL SALARY: '||NUM);
END;
/

			(OR)
DECLARE CURSOR C1 IS SELECT SAL FROM EMP;
NUM NUMBER:=0;
BEGIN
FOR I IN C1
LOOP
NUM := NUM+I.SAL;
END LOOP;
DBMS_OUTPUT.PUT_LINE('TOTAL SALARY: '||NUM);
END;
/
TOTAL SALARY: 32025


-----------------------------------------------------------------------------------

3.Write a pl/sql cursor program to find the maximum salary 
        without using max function by using 
               %rowcount attribute?
SOL:
----
DECLARE CURSOR C1 IS SELECT SAL FROM EMP;
MAX_SAL NUMBER := 0;
BEGIN
FOR I IN C1
LOOP
IF(I.SAL>MAX_SAL)
THEN
MAX_SAL := I.SAL;
END IF;
END LOOP;
DBMS_OUTPUT.PUT_LINE('MAXMIMUM SALARY IS: '||MAX_SAL);
END;
/
MAXMIMUM SALARY IS: 5000

				(OR)
DECLARE CURSOR C1 IS SELECT SAL FROM EMP ORDER BY SAL DESC;
V_SAL EMP.SAL%TYPE;
BEGIN
OPEN C1;
LOOP
FETCH C1 INTO V_SAL;
EXIT WHEN C1%ROWCOUNT>1;
DBMS_OUTPUT.PUT_LINE('MAX SALARY IS: '||V_SAL);
END LOOP;
END;
/
-----------------------------------------------------------------------------------

4.Write a pl/sql explicit cursor program which is used 
    to display even no of records from emp table
       by using %rowcount attribute?

%rowcoununt:-This attribute always returns number data type.i.e
=============     it counts no of records fetched from cursor 
                             memory area.

DECLARE CURSOR C1 IS SELECT ENAME,SAL FROM EMP;
V_ENAME VARCHAR2(10);
V_SAL NUMBER(10);
BEGIN
OPEN C1;
LOOP
FETCH C1 INTO V_ENAME,V_SAL;
EXIT WHEN C1%NOTFOUND;
IF MOD(C1%ROWCOUNT,2)=0 THEN
DBMS_OUTPUT.PUT_LINE(V_ENAME||','||V_SAL);
END IF;
END LOOP;
CLOSE C1;
END;
/

-----------------------------------------------------------------------------------



===========================================================================================================================================================================
21-03-25
********
                                   CURSORS
                                 ===========

Eliminating explicit cursor life cycle
         (or)
cursor for loop

  in oracle we can also eliminate explicit cursor life cycle by using
cursor for loop.This method also called as shortcut method of the 
explicit cursor.whenever we are using cursor for loop then we are
not required to use open,fetch,close statements in pl/sql block
because when we are using cursor for loop then oracle server only
internally automatically open the cursor and then fetch data from the
cursor and also close the cursor automatically after processing.

 cursor for loop syntax:-
 =======================
syntax:-
======
for indexvariablename in cursorname
loop
stmts;
end lop;

  This cursor for loop is used in executable section of
the pl/sql.

***NOTE:-In cursor for loop index variable internally behaves
======== like a record type variable(%rowtype)

NOTE:-in pl/sql we can also eliminate declare section of the 
=====    cursor....for loop.in this case we must specify cursor
         select statement in place of cursorname within cursor
         for loop;

syntax:-
======
for indexvariablename in(select statement)
loop
stmts;
end loop;

EG:-
===

1.Write a pl/sql program to display all ename,sal from emp table
  by using cursor for loop.

begin
for i in (select * from emp)
loop
dbms_output.put_line(i.ename||' '||i.sal);
end loop;
end;
/

-----------------------------------------------------------------------------------

2.Write a pl/sql explicit cursor program which is used to display
  5th record from emp table by using cursor for loop

A:
--
BEGIN
FOR I IN (SELECT EMP.*,ROWNUM FROM EMP WHERE ROWNUM<=5 MINUS SELECT EMP.*,ROWNUM FROM EMP WHERE ROWNUM<5)
LOOP DBMS_OUTPUT.PUT_LINE(I.ENAME||','||I.SAL);
END LOOP;
END;
/
MARTIN,1250

PL/SQL procedure successfully completed.
-----------------------------------------------------------------------------------

3.Write a pl/sql explicit cursor program which is used to display
   total salary from emp table without using sum() function
            by using cursor for loop?

A:
--
  1  declare
  2  cursor c1 is select * from emp;
  3  n number(10):=0;
  4  begin
  5  for i in c1
  6  loop
  7  n:=n+i.sal;
  8  end loop;
  9  dbms_output.put_line(n);
 10* end;
SQL> /
32025

-----------------------------------------------------------------------------------
=========================================================================================================================================================
24-03-25
********     
                    	 SUB PROGRAMS
                      ===================

     Sub programs are named pl/sql blocks. Which is used to solve
particular task. Oracle having 2 types of sub programs.

1.PROCEDURES
2.FUNCTIONS
  
                         SUB PROGRAMS
                            /     \
                           /       \
                     procedure     function
                  (May or may not  (Must return value)
                   return values)
       
                           PROCEDURES
                         =============

   Procedures is named PL/SQL block which is used to solve particular task and also procedure may or may not return values

   in oracle whenever we are using create or replace keyword infront of the procedure then those procedures are internally automatically perminently stored in oracle database. that's why those procedures are also called as stored as stored procedures.

Oracle Procedure having 2 parts. those are
1.Procedure Specification
2.Procedure Body

    In procedure specification we are specifying name of the procedure and type of the parameters. Whereas in procedure body we are solving actual task.

syntax:-
========     
create [or replace] procedure procedurename(formal parameters)
is/as
variable declaration, cursor, user defined exception;
 begin
 -----
 -----
 [exception]
 -----
 -----
end [procedurename];

To view errors:-
==============
syntax:-
=======
SQL>show errors;

Executing procedure:-
====================
Method1:-
=======
syntax:-
=======
SQL>exec procedurename(actual parameters);



1.in mode:-In oracle by default procedure parameter mode is IN
========== mode is used to pass the values in procedure body.IN mode internally behaves like a constant in procedure body.

syntax:-
=======
parametername in datatype


 *
*** Out Mode:-out mode is used to  return values from the
============ procedure. out parameter internally behaves like a unintialized variable in procedure body.here explicitly we must
specify out keyword.

syntax:-
=======
parameter out datatype

create or replace procedure p1(a in number,b out number)
is                                            |
begin                                  .out parameter always
b:=a*a;                                 behaves like a variable
end;                                   .when you specify out keyword 
/                                       no need to declare variable

    in oracle when a procedure having OUT or INOUT parameters 
then those type of procedures are allowed to execute by using
following 2 methods. thOse are

Method1:-using bind variable
Method2:-using anonymous block

NOTE:-catch the return values from server->bind variable

exec method1:-(using bind variable)
============
SQL>variable z number;
SQL>exec p1(8,:z);
SQL>print z;

      Z
   ------
      64

-----------------------------------------------------------------------------------

                        PROCEDURES
                     ===============

1.Write a pl/sql stored procedure for passing empno as a IN
     parameter then display name of the employee and 
             his salary from emp table?

CREATE OR REPLACE PROCEDURE P1(P_EMPNO IN NUMBER)
IS
V_ENAME VARCHAR2(10);
V_SAL NUMBER(8,2);
BEGIN
SELECT ENAME,SAL INTO V_ENAME,V_SAL FROM EMP WHERE EMPNO=P_EMPNO;
DBMS_OUTPUT.PUT_LINE(V_ENAME||','||V_SAL);
END;
/

Procedure created.

SQL> EXECUTE P1(7788);
SCOTT,3000
-----------------------------------------------------------------------------------
2.write a pl/sql stored procedure for passing deptno as a IN  
     parameter then display employee details from emp table 
           based on passed department number?

CREATE OR REPLACE PROCEDURE P2(P_DEPTNO IN NUMBER)
IS
CURSOR C1 IS SELECT * FROM EMP WHERE DEPTNO=P_DEPTNO;
BEGIN
FOR I IN C1
LOOP DBMS_OUTPUT.PUT_LINE(I.EMPNO||','||I.ENAME||','||I.SAL||','||I.HIREDATE);
END LOOP;
END;
/

Procedure created.
-----------------------------------------------------------------------------------
3.write a pl/sql stored procedure which is used to insert a record into dept table by using in parameter

CREATE OR REPLACE PROCEDURE P3(P_DEPTNO IN NUMBER,P_DNAME IN VARCHAR2,P_LOC IN VARCHAR2)
IS
BEGIN
INSERT INTO DEPT VALUES(P_DEPTNO,P_DNAME,P_LOC);
END;
/

Procedure created.

SQL> EXEC P3(60,'MANAGER','AMERICA');

PL/SQL procedure successfully completed.
-----------------------------------------------------------------------------------
4.Write a PL/SQL stored procedure for passing ename as IN
     parameter then return sal of the employee from
          emp table by using out parameter?

CREATE OR REPLACE PROCEDURE P4(P_ENAME IN VARCHAR2,P_SAL OUT NUMBER)
AS
BEGIN
SELECT SAL INTO P_SAL FROM EMP WHERE ENAME=P_ENAME;
END;
/

Procedure created.

SQL> VAR R NUMBER;
SQL> EXECUTE P4('SMITH',:R);

PL/SQL procedure successfully completed.

SQL> PRINT R;

         R
----------
       800
-----------------------------------------------------------------------------------
5.Write a pl/sql stored procedure which is used to converts
   following group by clause report into in,out parameters
                 from emp table?

SQL>select deptno,count(*)
    from emp
    group by deptno;

    DEPTNO        COUNT(*)
   --------      ----------
      30             6
      10             3
      20             5

CREATE OR REPLACE PROCEDURE P5(P_DEPTNO IN NUMBER,P_COUNT OUT NUMBER)
IS
BEGIN
SELECT COUNT(*) INTO P_COUNT FROM EMP WHERE DEPTNO=P_DEPTNO;
END;
/
SQL> VAR X NUMBER;
SQL> EXEC P5(30,:X);

PL/SQL procedure successfully completed.

SQL> PRINT X;
-----------------------------------------------------------------------------------
6.write a pl/sql stored procedure for passing deptno is in 
   parameter then return dname,location from dept table
          by using out parameter?

CREATE OR REPLACE PROCEDURE P6(P_DEPTNO IN NUMBER,P_DNAME OUT VARCHAR2,P_LOC OUT VARCHAR2)
AS
BEGIN
SELECT DNAME,LOC INTO P_DNAME,P_LOC FROM DEPT WHERE DEPTNO=P_DEPTNO;
END;

Procedure Created.

SQL> VAR RNAME VARCHAR2(20);
SQL> VAR RLOC VARCHAR2(20);
SQL> EXECUTE P6(10,:RNAME,:RLOC);

PL/SQL procedure successfully completed.

SQL> PRINT RNAME RLOC;
-----------------------------------------------------------------------------------
7.Write PL/SQL stored procedure for withdraw

Accno          Name          Bal
------        -------     ---------
1001          subbarao       3000
1002          gowtham        4000


if user entered amount is more than avaliable
 balance than---->insuffiencient funds

if user entered amount is less than avaliable 
 balance than ---->update his bal


CREATE OR REPLACE PROCEDURE WITHDRAW(P_ACCNO IN NUMBER,P_AMOUNT IN NUMBER)
IS
V_BAL NUMBER(10);
BEGIN
SELECT BAL INTO V_BAL FROM PTABLE WHERE ACCNO=P_ACCNO;
IF P_AMOUNT<=V_BAL THEN
UPDATE PTABLE SET BAL=BAL-P_AMOUNT;
ELSE
DBMS_OUTPUT.PUT_LINE('INSUFFICIANT FUNDS');
END IF;
END;
/
Procedure created.

SQL> EXEC WITHDRAW(1001,9000);
INSUFFICIANT FUNDS

PL/SQL procedure successfully completed.

SQL> EXEC WITHDRAW(1001,2000);

PL/SQL procedure successfully completed.

SQL> SELECT * FROM PTABLE;

========================================================================================================================================================================================================================









      

     
















































                             
                                  









